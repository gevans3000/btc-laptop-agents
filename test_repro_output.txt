============================= test session starts =============================
platform win32 -- Python 3.12.7, pytest-9.0.2, pluggy-1.5.0
rootdir: C:\Users\lovel\trading\btc-laptop-agents
configfile: pyproject.toml
plugins: anyio-4.9.0, asyncio-1.3.0, xdist-3.8.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collected 2 items

tests\test_run_reproducibility.py FF                                     [100%]

================================== FAILURES ===================================
________________________________ test_selftest ________________________________

    def test_selftest():
        print("1. Testing --mode selftest...")
        result = run_command(["-m", "laptop_agents", "run", "--mode", "selftest"])
    
        if result.returncode != 0:
            print("[FAIL] Selftest returned non-zero exit code.")
            print("STDERR:", result.stderr)
>           assert result.returncode == 0, f"Selftest failed with stderr: {result.stderr}"
E           AssertionError: Selftest failed with stderr: +--------------------- Traceback (most recent call last) ---------------------+
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
E             | 02 in emit                                                                  |
E             |                                                                             |
E             |   199                         if k not in ["timestamp", "event_id"]         |
E             |   200                     ]                                                 |
E             |   201                 )                                                     |
E             | > 202                 self.console.print(                                   |
E             |   203                     f"\U0001f539 [bold cyan]{event_name: <25}[/bold cyan] {me |
E             |   204                 )                                                     |
E             |   205         except Exception as e:                                        |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | event_name = 'SYSTEM_STARTUP'                                           | |
E             | |       meta = {                                                          | |
E             | |                  'event': 'SYSTEM_STARTUP',                             | |
E             | |                  'mode': 'selftest',                                    | |
E             | |                  'config': {                                            | |
E             | |                      'symbol': 'BTCUSDT',                               | |
E             | |                      'interval': '1m',                                  | |
E             | |                      'source': 'mock',                                  | |
E             | |                      'duration': 10,                                    | |
E             | |                      'execution_mode': 'paper',                         | |
E             | |                      'fees_bps': 2.0,                                   | |
E             | |                      'slip_bps': 0.5,                                   | |
E             | |                      'dry_run': False,                                  | |
E             | |                      'kill_switch': False                               | |
E             | |                  },                                                     | |
E             | |                  'event_id': '***',                                     | |
E             | |                  'timestamp': '2026-01-25T01:25:58.028854Z'             | |
E             | |              }                                                          | |
E             | |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]selftest  | |
E             | |              [dim]config=[/dim]{'sym"+169                               | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <EventPanelHandler (INFO)>                                 | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:1678 in print                                                            |
E             |                                                                             |
E             |   1675                 overflow = "ignore"                                  |
E             |   1676             crop = False                                             |
E             |   1677         render_hooks = self._render_hooks[:]                         |
E             | > 1678         with self:                                                   |
E             |   1679             renderables = self._collect_renderables(                 |
E             |   1680                 objects,                                             |
E             |   1681                 sep,                                                 |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer_extend = <built-in method extend of list object at              | |
E             | |                  0x00000199F0D2CC80>                                    | |
E             | |           crop = True                                                   | |
E             | |          emoji = None                                                   | |
E             | |            end = '\n'                                                   | |
E             | |         extend = <built-in method extend of list object at              | |
E             | |                  0x00000199F28A9100>                                    | |
E             | |         height = None                                                   | |
E             | |      highlight = None                                                   | |
E             | |        justify = None                                                   | |
E             | |           line = [                                                      | |
E             | |                      Segment(                                           | |
E             | |                          'False',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_red',                          | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=9                               | |
E             | |                              ),                                         | |
E             | |                              italic=True                                | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(', ', Style()),                            | |
E             | |                      Segment(                                           | |
E             | |                          "'kill_switch'",                               | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': ', Style()),                            | |
E             | |                      Segment(                                           | |
E             | |                          'False',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_red',                          | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=9                               | |
E             | |                              ),                                         | |
E             | |                              italic=True                                | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('}', Style(bold=True)),                    | |
E             | |                      Segment('\n')                                      | |
E             | |                  ]                                                      | |
E             | |         markup = None                                                   | |
E             | | new_line_start = False                                                  | |
E             | |   new_segments = [                                                      | |
E             | |                      Segment('\U0001f539 ', Style()),                           | |
E             | |                      Segment(                                           | |
E             | |                          'SYSTEM_STARTUP           ',                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True                                  | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' ', Style()),                             | |
E             | |                      Segment(                                           | |
E             | |                          'event',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'yellow',                              | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=3                               | |
E             | |                              ),                                         | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('=', Style(dim=True)),                     | |
E             | |                      Segment(                                           | |
E             | |                          'SYSTEM_STARTUP',                              | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'magenta',                             | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=5                               | |
E             | |                              ),                                         | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' ', Style()),                             | |
E             | |                      Segment(                                           | |
E             | |                          'mode',                                        | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'yellow',                              | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=3                               | |
E             | |                              ),                                         | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('=', Style(dim=True)),                     | |
E             | |                      Segment(                                           | |
E             | |                          'selftest',                                    | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'magenta',                             | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=5                               | |
E             | |                              ),                                         | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      ... +41                                            | |
E             | |                  ]                                                      | |
E             | |        no_wrap = None                                                   | |
E             | |        objects = (                                                      | |
E             | |                      '\U0001f539 [bold cyan]SYSTEM_STARTUP           [/bold     | |
E             | |                  cyan] [dim]event=[/dim]SYSTEM_START'+220,              | |
E             | |                  )                                                      | |
E             | |       overflow = None                                                   | |
E             | |         render = <bound method Console.render of <console width=79      | |
E             | |                  None>>                                                 | |
E             | |   render_hooks = []                                                     | |
E             | | render_options = ConsoleOptions(                                        | |
E             | |                      size=ConsoleDimensions(width=79, height=25),       | |
E             | |                      legacy_windows=True,                               | |
E             | |                      min_width=1,                                       | |
E             | |                      max_width=79,                                      | |
E             | |                      is_terminal=False,                                 | |
E             | |                      encoding='cp1252',                                 | |
E             | |                      max_height=25,                                     | |
E             | |                      justify=None,                                      | |
E             | |                      overflow=None,                                     | |
E             | |                      no_wrap=None,                                      | |
E             | |                      highlight=None,                                    | |
E             | |                      markup=None,                                       | |
E             | |                      height=None                                        | |
E             | |                  )                                                      | |
E             | |     renderable = <text "\U0001f539 SYSTEM_STARTUP                               | |
E             | |                  event=SYSTEM_STARTUP mode=selftest config={'symbol':   | |
E             | |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
E             | |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
E             | |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
E             | |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
E             | |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
E             | |                  'repr.attrib_name'), Span(54, 62,                      | |
E             | |                  'repr.attrib_value'), Span(63, 69,                     | |
E             | |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
E             | |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
E             | |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
E             | |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
E             | |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
E             | |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
E             | |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
E             | |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
E             | |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
E             | |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
E             | |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
E             | |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
E             | |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
E             | |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
E             | |                  ''>                                                    | |
E             | |    renderables = [                                                      | |
E             | |                      <text "\U0001f539 SYSTEM_STARTUP                           | |
E             | |                  event=SYSTEM_STARTUP mode=selftest config={'symbol':   | |
E             | |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
E             | |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
E             | |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
E             | |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
E             | |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
E             | |                  'repr.attrib_name'), Span(54, 62,                      | |
E             | |                  'repr.attrib_value'), Span(63, 69,                     | |
E             | |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
E             | |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
E             | |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
E             | |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
E             | |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
E             | |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
E             | |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
E             | |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
E             | |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
E             | |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
E             | |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
E             | |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
E             | |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
E             | |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
E             | |                  ''>                                                    | |
E             | |                  ]                                                      | |
E             | |           self = <console width=79 None>                                | |
E             | |            sep = ' '                                                    | |
E             | |      soft_wrap = False                                                  | |
E             | |          style = None                                                   | |
E             | |          width = None                                                   | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:864 in __exit__                                                          |
E             |                                                                             |
E             |    861                                                                      |
E             |    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
E             |    863         """Exit buffer context."""                                   |
E             | >  864         self._exit_buffer()                                          |
E             |    865                                                                      |
E             |    866     def begin_capture(self) -> None:                                 |
E             |    867         """Begin capturing console output. Call :meth:`end_capture`  |
E             |                                                                             |
E             | +-------------- locals ---------------+                                     |
E             | |  exc_type = None                    |                                     |
E             | | exc_value = None                    |                                     |
E             | |      self = <console width=79 None> |                                     |
E             | | traceback = None                    |                                     |
E             | +-------------------------------------+                                     |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:822 in _exit_buffer                                                      |
E             |                                                                             |
E             |    819     def _exit_buffer(self) -> None:                                  |
E             |    820         """Leave buffer context, and render content if required."""  |
E             |    821         self._buffer_index -= 1                                      |
E             | >  822         self._check_buffer()                                         |
E             |    823                                                                      |
E             |    824     def set_live(self, live: "Live") -> None:                        |
E             |    825         """Set Live instance. Used by Live context manager.          |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2019 in _check_buffer                                                    |
E             |                                                                             |
E             |   2016             return                                                   |
E             |   2017                                                                      |
E             |   2018         try:                                                         |
E             | > 2019             self._write_buffer()                                     |
E             |   2020         except BrokenPipeError:                                      |
E             |   2021             self.on_broken_pipe()                                    |
E             |   2022                                                                      |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2055 in _write_buffer                                                    |
E             |                                                                             |
E             |   2052                             if self.no_color and self._color_system: |
E             |   2053                                 buffer = list(Segment.remove_color(b |
E             |   2054                                                                      |
E             | > 2055                             legacy_windows_render(buffer, LegacyWind |
E             |   2056                         else:                                        |
E             |   2057                             # Either a non-std stream on legacy Wind |
E             |   2058                             text = self._render_buffer(self._buffer[ |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    buffer = [                                           | |
E             | |                                 Segment('\U0001f539 ', Style()),                | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP           ',        | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'cyan',                     | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=6                    | |
E             | |                                         ),                              | |
E             | |                                         bold=True                       | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'event',                            | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP',                   | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'mode',                             | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'selftest',                         | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 ... +44                                 | |
E             | |                             ]                                           | |
E             | |                    fileno = 1                                           | |
E             | |                      self = <console width=79 None>                     | |
E             | | use_legacy_windows_render = True                                        | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
E             | _renderer.py:19 in legacy_windows_render                                    |
E             |                                                                             |
E             |   16             if style:                                                  |
E             |   17                 term.write_styled(text, style)                         |
E             |   18             else:                                                      |
E             | > 19                 term.write_text(text)                                  |
E             |   20         else:                                                          |
E             |   21             control_codes: Sequence[ControlCode] = control             |
E             |   22             for control_code in control_codes:                         |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer = [                                                             | |
E             | |               Segment('\U0001f539 ', Style()),                                  | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP           ',                          | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'cyan',                                       | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=6                                      | |
E             | |                       ),                                                | |
E             | |                       bold=True                                         | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'event',                                              | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP',                                     | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'mode',                                               | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'selftest',                                           | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               ... +44                                                   | |
E             | |           ]                                                             | |
E             | | control = None                                                          | |
E             | |   style = Style()                                                       | |
E             | |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
E             | |           0x00000199F214EBA0>                                           | |
E             | |    text = '\U0001f539 '                                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
E             | onsole.py:402 in write_text                                                 |
E             |                                                                             |
E             |   399         Args:                                                         |
E             |   400             text (str): The text to write to the console              |
E             |   401         """                                                           |
E             | > 402         self.write(text)                                              |
E             |   403         self.flush()                                                  |
E             |   404                                                                       |
E             |   405     def write_styled(self, text: str, style: Style) -> None:          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
E             | |        0x00000199F214EBA0>                                              | |
E             | | text = '\U0001f539 '                                                            | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
E             |                                                                             |
E             |    16                                                                       |
E             |    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
E             |    18     def encode(self, input, final=False):                             |
E             | >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
E             |    20                                                                       |
E             |    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
E             |    22     def decode(self, input, final=False):                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | final = False                                                           | |
E             | | input = '\U0001f539 '                                                           | |
E             | |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
E             | |         0x00000199ED60BE90>                                             | |
E             | +-------------------------------------------------------------------------+ |
E             +-----------------------------------------------------------------------------+
E             UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
E             position 0: character maps to <undefined>
E             
E             During handling of the above exception, another exception occurred:
E             
E             +--------------------- Traceback (most recent call last) ---------------------+
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\commands\session |
E             | .py:207 in run                                                              |
E             |                                                                             |
E             |   204                                                                       |
E             |   205     mode = args.mode or ("backtest" if args.backtest > 0 else "single |
E             |   206                                                                       |
E             | > 207     append_event(                                                     |
E             |   208         {                                                             |
E             |   209             "event": "SYSTEM_STARTUP",                                |
E             |   210             "mode": mode,                                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    args = namespace(source='mock', symbol='BTCUSDT',    | |
E             | |                           interval='1m', limit=200, fees_bps=2.0,       | |
E             | |                           slip_bps=0.5, backtest=0,                     | |
E             | |                           backtest_mode='position', mode='selftest',    | |
E             | |                           duration=10, once=False,                      | |
E             | |                           execution_mode='paper', risk_pct=1.0,         | |
E             | |                           stop_bps=30.0, tp_r=1.5, max_leverage=1.0,    | |
E             | |                           intrabar_mode='conservative',                 | |
E             | |                           validate_splits=5, validate_train=600,        | |
E             | |                           validate_test=200,                            | |
E             | |                           grid='sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0à | |
E             | |                           validate_max_candidates=200, dry_run=False,   | |
E             | |                           show=False, strategy='default',               | |
E             | |                           async_mode=True, stale_timeout=120,           | |
E             | |                           execution_latency_ms=200, dashboard=False,    | |
E             | |                           preflight=False, replay=None, config=None,    | |
E             | |                           quiet=False, verbose=False)                   | |
E             | |              async_mode = True                                          | |
E             | |                  atexit = <module 'atexit' (built-in)>                  | |
E             | |                backtest = 0                                             | |
E             | |           backtest_mode = 'position'                                    | |
E             | |                  config = None                                          | |
E             | |               dashboard = False                                         | |
E             | |                 dry_run = False                                         | |
E             | |                duration = 10                                            | |
E             | |    execution_latency_ms = 200                                           | |
E             | |          execution_mode = 'paper'                                       | |
E             | |                fees_bps = 2.0                                           | |
E             | |                    grid = 'sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0'      | |
E             | |                interval = '1m'                                          | |
E             | |           intrabar_mode = 'conservative'                                | |
E             | |                   limit = 200                                           | |
E             | |                    lock = <laptop_agents.core.lock_manager.LockManager  | |
E             | |                           object at 0x00000199F288FF50>                 | |
E             | |            max_leverage = 1.0                                           | |
E             | |                    mode = 'selftest'                                    | |
E             | |                    once = False                                         | |
E             | |               preflight = False                                         | |
E             | |                   quiet = False                                         | |
E             | |                  replay = None                                          | |
E             | |                risk_pct = 1.0                                           | |
E             | |          session_config = SessionConfig(                                | |
E             | |                               symbol='BTCUSDT',                         | |
E             | |                               interval='1m',                            | |
E             | |                               source='mock',                            | |
E             | |                               duration=10,                              | |
E             | |                               execution_mode='paper',                   | |
E             | |                               fees_bps=2.0,                             | |
E             | |                               slip_bps=0.5,                             | |
E             | |                               dry_run=False,                            | |
E             | |                               kill_switch=False                         | |
E             | |                           )                                             | |
E             | |                    show = False                                         | |
E             | |                slip_bps = 0.5                                           | |
E             | |                  source = 'mock'                                        | |
E             | |           stale_timeout = 120                                           | |
E             | |                stop_bps = 30.0                                          | |
E             | |                strategy = 'default'                                     | |
E             | |                  symbol = 'BTCUSDT'                                     | |
E             | |                    tp_r = 1.5                                           | |
E             | | validate_max_candidates = 200                                           | |
E             | |         validate_splits = 5                                             | |
E             | |           validate_test = 200                                           | |
E             | |          validate_train = 600                                           | |
E             | |                 verbose = False                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\events.py:5 |
E             | 2 in append_event                                                           |
E             |                                                                             |
E             |   49                                                                        |
E             |   50     obj.setdefault("timestamp", utc_ts())                              |
E             |   51     event_name = obj.get("event", "UnnamedEvent")                      |
E             | > 52     logger.info(f"EVENT: {event_name}", obj)                           |
E             |   53                                                                        |
E             |   54     if paper:                                                          |
E             |   55         PAPER_DIR.mkdir(parents=True, exist_ok=True)  # Ensure parents |
E             |                                                                             |
E             | +----------------------------- locals -----------------------------+        |
E             | |    content = {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'selftest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  }                                               |        |
E             | |              }                                                   |        |
E             | |   event_id = '712c2b61b0405a8b4fe37ca994a175b0'                  |        |
E             | | event_name = 'SYSTEM_STARTUP'                                    |        |
E             | |        obj = {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'selftest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  },                                              |        |
E             | |                  'event_id': '712c2b61b0405a8b4fe37ca994a175b0', |        |
E             | |                  'timestamp': '2026-01-25T01:25:58.028854Z'      |        |
E             | |              }                                                   |        |
E             | |      paper = True                                                |        |
E             | +------------------------------------------------------------------+        |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1539 in info              |
E             |                                                                             |
E             |   1536         logger.info("Houston, we have a %s", "notable problem", exc_ |
E             |   1537         """                                                          |
E             |   1538         if self.isEnabledFor(INFO):                                  |
E             | > 1539             self._log(INFO, msg, args, **kwargs)                     |
E             |   1540                                                                      |
E             |   1541     def warning(self, msg, *args, **kwargs):                         |
E             |   1542         """                                                          |
E             |                                                                             |
E             | +----------------------------- locals -----------------------------+        |
E             | |   args = (                                                       |        |
E             | |              {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'selftest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  },                                              |        |
E             | |                  'event_id': '712c2b61b0405a8b4fe37ca994a175b0', |        |
E             | |                  'timestamp': '2026-01-25T01:25:58.028854Z'      |        |
E             | |              },                                                  |        |
E             | |          )                                                       |        |
E             | | kwargs = {}                                                      |        |
E             | |    msg = 'EVENT: SYSTEM_STARTUP'                                 |        |
E             | |   self = <Logger btc_agents (INFO)>                              |        |
E             | +------------------------------------------------------------------+        |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1684 in _log              |
E             |                                                                             |
E             |   1681                 exc_info = sys.exc_info()                            |
E             |   1682         record = self.makeRecord(self.name, level, fn, lno, msg, arg |
E             |   1683                                  exc_info, func, extra, sinfo)       |
E             | > 1684         self.handle(record)                                          |
E             |   1685                                                                      |
E             |   1686     def handle(self, record):                                        |
E             |   1687         """                                                          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |       args = (                                                          | |
E             | |                  {                                                      | |
E             | |                      'event': 'SYSTEM_STARTUP',                         | |
E             | |                      'mode': 'selftest',                                | |
E             | |                      'config': {                                        | |
E             | |                          'symbol': 'BTCUSDT',                           | |
E             | |                          'interval': '1m',                              | |
E             | |                          'source': 'mock',                              | |
E             | |                          'duration': 10,                                | |
E             | |                          'execution_mode': 'paper',                     | |
E             | |                          'fees_bps': 2.0,                               | |
E             | |                          'slip_bps': 0.5,                               | |
E             | |                          'dry_run': False,                              | |
E             | |                          'kill_switch': False                           | |
E             | |                      },                                                 | |
E             | |                      'event_id': '712c2b61b0405a8b4fe37ca994a175b0',    | |
E             | |                      'timestamp': '2026-01-25T01:25:58.028854Z'         | |
E             | |                  },                                                     | |
E             | |              )                                                          | |
E             | |   exc_info = None                                                       | |
E             | |      extra = None                                                       | |
E             | |         fn = 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\src\\laptoà | |
E             | |       func = 'append_event'                                             | |
E             | |      level = 20                                                         | |
E             | |        lno = 52                                                         | |
E             | |        msg = 'EVENT: SYSTEM_STARTUP'                                    | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <Logger btc_agents (INFO)>                                 | |
E             | |      sinfo = None                                                       | |
E             | | stack_info = False                                                      | |
E             | | stacklevel = 1                                                          | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1700 in handle            |
E             |                                                                             |
E             |   1697             return                                                   |
E             |   1698         if isinstance(maybe_record, LogRecord):                      |
E             |   1699             record = maybe_record                                    |
E             | > 1700         self.callHandlers(record)                                    |
E             |   1701                                                                      |
E             |   1702     def addHandler(self, hdlr):                                      |
E             |   1703         """                                                          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | maybe_record = <LogRecord: btc_agents, 20,                              | |
E             | |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
E             | |                52, "EVENT: SYSTEM_STARTUP">                             | |
E             | |       record = <LogRecord: btc_agents, 20,                              | |
E             | |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
E             | |                52, "EVENT: SYSTEM_STARTUP">                             | |
E             | |         self = <Logger btc_agents (INFO)>                               | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1762 in callHandlers      |
E             |                                                                             |
E             |   1759             for hdlr in c.handlers:                                  |
E             |   1760                 found = found + 1                                    |
E             |   1761                 if record.levelno >= hdlr.level:                     |
E             | > 1762                     hdlr.handle(record)                              |
E             |   1763             if not c.propagate:                                      |
E             |   1764                 c = None    #break out                               |
E             |   1765             else:                                                    |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |      c = <Logger btc_agents (INFO)>                                     | |
E             | |  found = 3                                                              | |
E             | |   hdlr = <EventPanelHandler (INFO)>                                     | |
E             | | record = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |   self = <Logger btc_agents (INFO)>                                     | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1028 in handle            |
E             |                                                                             |
E             |   1025         if rv:                                                       |
E             |   1026             self.acquire()                                           |
E             |   1027             try:                                                     |
E             | > 1028                 self.emit(record)                                    |
E             |   1029             finally:                                                 |
E             |   1030                 self.release()                                       |
E             |   1031         return rv                                                    |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | record = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |     rv = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |   self = <EventPanelHandler (INFO)>                                     | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
E             | 07 in emit                                                                  |
E             |                                                                             |
E             |   204                 )                                                     |
E             |   205         except Exception as e:                                        |
E             |   206             # Fallback for panel errors                               |
E             | > 207             self.console.print(                                       |
E             |   208                 f"[dim](Panel Format Error: {e})[/dim] {record.getMes |
E             |   209             )                                                         |
E             |   210                                                                       |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | event_name = 'SYSTEM_STARTUP'                                           | |
E             | |       meta = {                                                          | |
E             | |                  'event': 'SYSTEM_STARTUP',                             | |
E             | |                  'mode': 'selftest',                                    | |
E             | |                  'config': {                                            | |
E             | |                      'symbol': 'BTCUSDT',                               | |
E             | |                      'interval': '1m',                                  | |
E             | |                      'source': 'mock',                                  | |
E             | |                      'duration': 10,                                    | |
E             | |                      'execution_mode': 'paper',                         | |
E             | |                      'fees_bps': 2.0,                                   | |
E             | |                      'slip_bps': 0.5,                                   | |
E             | |                      'dry_run': False,                                  | |
E             | |                      'kill_switch': False                               | |
E             | |                  },                                                     | |
E             | |                  'event_id': '***',                                     | |
E             | |                  'timestamp': '2026-01-25T01:25:58.028854Z'             | |
E             | |              }                                                          | |
E             | |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]selftest  | |
E             | |              [dim]config=[/dim]{'sym"+169                               | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <EventPanelHandler (INFO)>                                 | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:1678 in print                                                            |
E             |                                                                             |
E             |   1675                 overflow = "ignore"                                  |
E             |   1676             crop = False                                             |
E             |   1677         render_hooks = self._render_hooks[:]                         |
E             | > 1678         with self:                                                   |
E             |   1679             renderables = self._collect_renderables(                 |
E             |   1680                 objects,                                             |
E             |   1681                 sep,                                                 |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer_extend = <built-in method extend of list object at              | |
E             | |                  0x00000199F0D2CC80>                                    | |
E             | |           crop = True                                                   | |
E             | |          emoji = None                                                   | |
E             | |            end = '\n'                                                   | |
E             | |         extend = <built-in method extend of list object at              | |
E             | |                  0x00000199F28A8680>                                    | |
E             | |         height = None                                                   | |
E             | |      highlight = None                                                   | |
E             | |        justify = None                                                   | |
E             | |           line = [                                                      | |
E             | |                      Segment('position ', Style(dim=True)),             | |
E             | |                      Segment(                                           | |
E             | |                          '0',                                           | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': character maps to ', Style(dim=True)),  | |
E             | |                      Segment('<', Style(bold=True, dim=True)),          | |
E             | |                      Segment(                                           | |
E             | |                          'undefined',                                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_magenta',                      | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=13                              | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True                                   | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('>', Style(bold=True, dim=True)),          | |
E             | |                      Segment(')', Style(bold=True, dim=True)),          | |
E             | |                      Segment(' EVENT: SYSTEM_STARTUP', Style()),        | |
E             | |                      Segment('\n')                                      | |
E             | |                  ]                                                      | |
E             | |         markup = None                                                   | |
E             | | new_line_start = False                                                  | |
E             | |   new_segments = [                                                      | |
E             | |                      Segment('(', Style(bold=True, dim=True)),          | |
E             | |                      Segment('Panel Format Error: ', Style(dim=True)),  | |
E             | |                      Segment(                                           | |
E             | |                          "'charmap'",                                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(                                           | |
E             | |                          " codec can't encode character ",              | |
E             | |                          Style(dim=True)                                | |
E             | |                      ),                                                 | |
E             | |                      Segment(                                           | |
E             | |                          "'\\U0001f539'",                               | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' in ', Style(dim=True)),                  | |
E             | |                      Segment('\n', Style()),                            | |
E             | |                      Segment('position ', Style(dim=True)),             | |
E             | |                      Segment(                                           | |
E             | |                          '0',                                           | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': character maps to ', Style(dim=True)),  | |
E             | |                      ... +6                                             | |
E             | |                  ]                                                      | |
E             | |        no_wrap = None                                                   | |
E             | |        objects = (                                                      | |
E             | |                      "[dim](Panel Format Error: 'charmap' codec can't   | |
E             | |                  encode character '\\U0001f539' in"+71,                 | |
E             | |                  )                                                      | |
E             | |       overflow = None                                                   | |
E             | |         render = <bound method Console.render of <console width=79      | |
E             | |                  None>>                                                 | |
E             | |   render_hooks = []                                                     | |
E             | | render_options = ConsoleOptions(                                        | |
E             | |                      size=ConsoleDimensions(width=79, height=25),       | |
E             | |                      legacy_windows=True,                               | |
E             | |                      min_width=1,                                       | |
E             | |                      max_width=79,                                      | |
E             | |                      is_terminal=False,                                 | |
E             | |                      encoding='cp1252',                                 | |
E             | |                      max_height=25,                                     | |
E             | |                      justify=None,                                      | |
E             | |                      overflow=None,                                     | |
E             | |                      no_wrap=None,                                      | |
E             | |                      highlight=None,                                    | |
E             | |                      markup=None,                                       | |
E             | |                      height=None                                        | |
E             | |                  )                                                      | |
E             | |     renderable = <text "(Panel Format Error: 'charmap' codec can't      | |
E             | |                  encode character '\\U0001f539' in position 0:          | |
E             | |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
E             | |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
E             | |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
E             | |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
E             | |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
E             | |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
E             | |                  'dim')] ''>                                            | |
E             | |    renderables = [                                                      | |
E             | |                      <text "(Panel Format Error: 'charmap' codec can't  | |
E             | |                  encode character '\\U0001f539' in position 0:          | |
E             | |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
E             | |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
E             | |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
E             | |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
E             | |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
E             | |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
E             | |                  'dim')] ''>                                            | |
E             | |                  ]                                                      | |
E             | |           self = <console width=79 None>                                | |
E             | |            sep = ' '                                                    | |
E             | |      soft_wrap = False                                                  | |
E             | |          style = None                                                   | |
E             | |          width = None                                                   | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:864 in __exit__                                                          |
E             |                                                                             |
E             |    861                                                                      |
E             |    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
E             |    863         """Exit buffer context."""                                   |
E             | >  864         self._exit_buffer()                                          |
E             |    865                                                                      |
E             |    866     def begin_capture(self) -> None:                                 |
E             |    867         """Begin capturing console output. Call :meth:`end_capture`  |
E             |                                                                             |
E             | +-------------- locals ---------------+                                     |
E             | |  exc_type = None                    |                                     |
E             | | exc_value = None                    |                                     |
E             | |      self = <console width=79 None> |                                     |
E             | | traceback = None                    |                                     |
E             | +-------------------------------------+                                     |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:822 in _exit_buffer                                                      |
E             |                                                                             |
E             |    819     def _exit_buffer(self) -> None:                                  |
E             |    820         """Leave buffer context, and render content if required."""  |
E             |    821         self._buffer_index -= 1                                      |
E             | >  822         self._check_buffer()                                         |
E             |    823                                                                      |
E             |    824     def set_live(self, live: "Live") -> None:                        |
E             |    825         """Set Live instance. Used by Live context manager.          |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2019 in _check_buffer                                                    |
E             |                                                                             |
E             |   2016             return                                                   |
E             |   2017                                                                      |
E             |   2018         try:                                                         |
E             | > 2019             self._write_buffer()                                     |
E             |   2020         except BrokenPipeError:                                      |
E             |   2021             self.on_broken_pipe()                                    |
E             |   2022                                                                      |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2055 in _write_buffer                                                    |
E             |                                                                             |
E             |   2052                             if self.no_color and self._color_system: |
E             |   2053                                 buffer = list(Segment.remove_color(b |
E             |   2054                                                                      |
E             | > 2055                             legacy_windows_render(buffer, LegacyWind |
E             |   2056                         else:                                        |
E             |   2057                             # Either a non-std stream on legacy Wind |
E             |   2058                             text = self._render_buffer(self._buffer[ |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    buffer = [                                           | |
E             | |                                 Segment('\U0001f539 ', Style()),                | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP           ',        | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'cyan',                     | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=6                    | |
E             | |                                         ),                              | |
E             | |                                         bold=True                       | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'event',                            | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP',                   | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'mode',                             | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'selftest',                         | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 ... +60                                 | |
E             | |                             ]                                           | |
E             | |                    fileno = 1                                           | |
E             | |                      self = <console width=79 None>                     | |
E             | | use_legacy_windows_render = True                                        | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
E             | _renderer.py:19 in legacy_windows_render                                    |
E             |                                                                             |
E             |   16             if style:                                                  |
E             |   17                 term.write_styled(text, style)                         |
E             |   18             else:                                                      |
E             | > 19                 term.write_text(text)                                  |
E             |   20         else:                                                          |
E             |   21             control_codes: Sequence[ControlCode] = control             |
E             |   22             for control_code in control_codes:                         |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer = [                                                             | |
E             | |               Segment('\U0001f539 ', Style()),                                  | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP           ',                          | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'cyan',                                       | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=6                                      | |
E             | |                       ),                                                | |
E             | |                       bold=True                                         | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'event',                                              | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP',                                     | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'mode',                                               | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'selftest',                                           | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               ... +60                                                   | |
E             | |           ]                                                             | |
E             | | control = None                                                          | |
E             | |   style = Style()                                                       | |
E             | |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
E             | |           0x00000199F28A0500>                                           | |
E             | |    text = '\U0001f539 '                                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
E             | onsole.py:402 in write_text                                                 |
E             |                                                                             |
E             |   399         Args:                                                         |
E             |   400             text (str): The text to write to the console              |
E             |   401         """                                                           |
E             | > 402         self.write(text)                                              |
E             |   403         self.flush()                                                  |
E             |   404                                                                       |
E             |   405     def write_styled(self, text: str, style: Style) -> None:          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
E             | |        0x00000199F28A0500>                                              | |
E             | | text = '\U0001f539 '                                                            | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
E             |                                                                             |
E             |    16                                                                       |
E             |    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
E             |    18     def encode(self, input, final=False):                             |
E             | >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
E             |    20                                                                       |
E             |    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
E             |    22     def decode(self, input, final=False):                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | final = False                                                           | |
E             | | input = '\U0001f539 '                                                           | |
E             | |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
E             | |         0x00000199ED60BE90>                                             | |
E             | +-------------------------------------------------------------------------+ |
E             +-----------------------------------------------------------------------------+
E             UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
E             position 0: character maps to <undefined>
E             
E           assert 1 == 0
E            +  where 1 = CompletedProcess(args=['C:\\ProgramData\\miniconda3\\python.exe', '-m', 'laptop_agents', 'run', '--mode', 'selftest'],...codeError: \'charmap\' codec can\'t encode character \'\\U0001f539\' in \nposition 0: character maps to <undefined>\n').returncode

tests\test_run_reproducibility.py:31: AssertionError
---------------------------- Captured stdout call -----------------------------
1. Testing --mode selftest...
[FAIL] Selftest returned non-zero exit code.
STDERR: +--------------------- Traceback (most recent call last) ---------------------+
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
| 02 in emit                                                                  |
|                                                                             |
|   199                         if k not in ["timestamp", "event_id"]         |
|   200                     ]                                                 |
|   201                 )                                                     |
| > 202                 self.console.print(                                   |
|   203                     f"\U0001f539 [bold cyan]{event_name: <25}[/bold cyan] {me |
|   204                 )                                                     |
|   205         except Exception as e:                                        |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | event_name = 'SYSTEM_STARTUP'                                           | |
| |       meta = {                                                          | |
| |                  'event': 'SYSTEM_STARTUP',                             | |
| |                  'mode': 'selftest',                                    | |
| |                  'config': {                                            | |
| |                      'symbol': 'BTCUSDT',                               | |
| |                      'interval': '1m',                                  | |
| |                      'source': 'mock',                                  | |
| |                      'duration': 10,                                    | |
| |                      'execution_mode': 'paper',                         | |
| |                      'fees_bps': 2.0,                                   | |
| |                      'slip_bps': 0.5,                                   | |
| |                      'dry_run': False,                                  | |
| |                      'kill_switch': False                               | |
| |                  },                                                     | |
| |                  'event_id': '***',                                     | |
| |                  'timestamp': '2026-01-25T01:25:58.028854Z'             | |
| |              }                                                          | |
| |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]selftest  | |
| |              [dim]config=[/dim]{'sym"+169                               | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <EventPanelHandler (INFO)>                                 | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:1678 in print                                                            |
|                                                                             |
|   1675                 overflow = "ignore"                                  |
|   1676             crop = False                                             |
|   1677         render_hooks = self._render_hooks[:]                         |
| > 1678         with self:                                                   |
|   1679             renderables = self._collect_renderables(                 |
|   1680                 objects,                                             |
|   1681                 sep,                                                 |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer_extend = <built-in method extend of list object at              | |
| |                  0x00000199F0D2CC80>                                    | |
| |           crop = True                                                   | |
| |          emoji = None                                                   | |
| |            end = '\n'                                                   | |
| |         extend = <built-in method extend of list object at              | |
| |                  0x00000199F28A9100>                                    | |
| |         height = None                                                   | |
| |      highlight = None                                                   | |
| |        justify = None                                                   | |
| |           line = [                                                      | |
| |                      Segment(                                           | |
| |                          'False',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_red',                          | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=9                               | |
| |                              ),                                         | |
| |                              italic=True                                | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(', ', Style()),                            | |
| |                      Segment(                                           | |
| |                          "'kill_switch'",                               | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': ', Style()),                            | |
| |                      Segment(                                           | |
| |                          'False',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_red',                          | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=9                               | |
| |                              ),                                         | |
| |                              italic=True                                | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('}', Style(bold=True)),                    | |
| |                      Segment('\n')                                      | |
| |                  ]                                                      | |
| |         markup = None                                                   | |
| | new_line_start = False                                                  | |
| |   new_segments = [                                                      | |
| |                      Segment('\U0001f539 ', Style()),                           | |
| |                      Segment(                                           | |
| |                          'SYSTEM_STARTUP           ',                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True                                  | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' ', Style()),                             | |
| |                      Segment(                                           | |
| |                          'event',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'yellow',                              | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=3                               | |
| |                              ),                                         | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('=', Style(dim=True)),                     | |
| |                      Segment(                                           | |
| |                          'SYSTEM_STARTUP',                              | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'magenta',                             | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=5                               | |
| |                              ),                                         | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' ', Style()),                             | |
| |                      Segment(                                           | |
| |                          'mode',                                        | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'yellow',                              | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=3                               | |
| |                              ),                                         | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('=', Style(dim=True)),                     | |
| |                      Segment(                                           | |
| |                          'selftest',                                    | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'magenta',                             | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=5                               | |
| |                              ),                                         | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      ... +41                                            | |
| |                  ]                                                      | |
| |        no_wrap = None                                                   | |
| |        objects = (                                                      | |
| |                      '\U0001f539 [bold cyan]SYSTEM_STARTUP           [/bold     | |
| |                  cyan] [dim]event=[/dim]SYSTEM_START'+220,              | |
| |                  )                                                      | |
| |       overflow = None                                                   | |
| |         render = <bound method Console.render of <console width=79      | |
| |                  None>>                                                 | |
| |   render_hooks = []                                                     | |
| | render_options = ConsoleOptions(                                        | |
| |                      size=ConsoleDimensions(width=79, height=25),       | |
| |                      legacy_windows=True,                               | |
| |                      min_width=1,                                       | |
| |                      max_width=79,                                      | |
| |                      is_terminal=False,                                 | |
| |                      encoding='cp1252',                                 | |
| |                      max_height=25,                                     | |
| |                      justify=None,                                      | |
| |                      overflow=None,                                     | |
| |                      no_wrap=None,                                      | |
| |                      highlight=None,                                    | |
| |                      markup=None,                                       | |
| |                      height=None                                        | |
| |                  )                                                      | |
| |     renderable = <text "\U0001f539 SYSTEM_STARTUP                               | |
| |                  event=SYSTEM_STARTUP mode=selftest config={'symbol':   | |
| |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
| |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
| |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
| |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
| |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
| |                  'repr.attrib_name'), Span(54, 62,                      | |
| |                  'repr.attrib_value'), Span(63, 69,                     | |
| |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
| |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
| |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
| |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
| |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
| |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
| |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
| |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
| |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
| |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
| |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
| |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
| |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
| |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
| |                  ''>                                                    | |
| |    renderables = [                                                      | |
| |                      <text "\U0001f539 SYSTEM_STARTUP                           | |
| |                  event=SYSTEM_STARTUP mode=selftest config={'symbol':   | |
| |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
| |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
| |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
| |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
| |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
| |                  'repr.attrib_name'), Span(54, 62,                      | |
| |                  'repr.attrib_value'), Span(63, 69,                     | |
| |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
| |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
| |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
| |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
| |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
| |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
| |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
| |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
| |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
| |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
| |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
| |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
| |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
| |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
| |                  ''>                                                    | |
| |                  ]                                                      | |
| |           self = <console width=79 None>                                | |
| |            sep = ' '                                                    | |
| |      soft_wrap = False                                                  | |
| |          style = None                                                   | |
| |          width = None                                                   | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:864 in __exit__                                                          |
|                                                                             |
|    861                                                                      |
|    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
|    863         """Exit buffer context."""                                   |
| >  864         self._exit_buffer()                                          |
|    865                                                                      |
|    866     def begin_capture(self) -> None:                                 |
|    867         """Begin capturing console output. Call :meth:`end_capture`  |
|                                                                             |
| +-------------- locals ---------------+                                     |
| |  exc_type = None                    |                                     |
| | exc_value = None                    |                                     |
| |      self = <console width=79 None> |                                     |
| | traceback = None                    |                                     |
| +-------------------------------------+                                     |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:822 in _exit_buffer                                                      |
|                                                                             |
|    819     def _exit_buffer(self) -> None:                                  |
|    820         """Leave buffer context, and render content if required."""  |
|    821         self._buffer_index -= 1                                      |
| >  822         self._check_buffer()                                         |
|    823                                                                      |
|    824     def set_live(self, live: "Live") -> None:                        |
|    825         """Set Live instance. Used by Live context manager.          |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2019 in _check_buffer                                                    |
|                                                                             |
|   2016             return                                                   |
|   2017                                                                      |
|   2018         try:                                                         |
| > 2019             self._write_buffer()                                     |
|   2020         except BrokenPipeError:                                      |
|   2021             self.on_broken_pipe()                                    |
|   2022                                                                      |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2055 in _write_buffer                                                    |
|                                                                             |
|   2052                             if self.no_color and self._color_system: |
|   2053                                 buffer = list(Segment.remove_color(b |
|   2054                                                                      |
| > 2055                             legacy_windows_render(buffer, LegacyWind |
|   2056                         else:                                        |
|   2057                             # Either a non-std stream on legacy Wind |
|   2058                             text = self._render_buffer(self._buffer[ |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    buffer = [                                           | |
| |                                 Segment('\U0001f539 ', Style()),                | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP           ',        | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'cyan',                     | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=6                    | |
| |                                         ),                              | |
| |                                         bold=True                       | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'event',                            | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP',                   | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'mode',                             | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'selftest',                         | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 ... +44                                 | |
| |                             ]                                           | |
| |                    fileno = 1                                           | |
| |                      self = <console width=79 None>                     | |
| | use_legacy_windows_render = True                                        | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
| _renderer.py:19 in legacy_windows_render                                    |
|                                                                             |
|   16             if style:                                                  |
|   17                 term.write_styled(text, style)                         |
|   18             else:                                                      |
| > 19                 term.write_text(text)                                  |
|   20         else:                                                          |
|   21             control_codes: Sequence[ControlCode] = control             |
|   22             for control_code in control_codes:                         |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer = [                                                             | |
| |               Segment('\U0001f539 ', Style()),                                  | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP           ',                          | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'cyan',                                       | |
| |                           ColorType.STANDARD,                           | |
| |                           number=6                                      | |
| |                       ),                                                | |
| |                       bold=True                                         | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'event',                                              | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP',                                     | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'mode',                                               | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'selftest',                                           | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               ... +44                                                   | |
| |           ]                                                             | |
| | control = None                                                          | |
| |   style = Style()                                                       | |
| |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
| |           0x00000199F214EBA0>                                           | |
| |    text = '\U0001f539 '                                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
| onsole.py:402 in write_text                                                 |
|                                                                             |
|   399         Args:                                                         |
|   400             text (str): The text to write to the console              |
|   401         """                                                           |
| > 402         self.write(text)                                              |
|   403         self.flush()                                                  |
|   404                                                                       |
|   405     def write_styled(self, text: str, style: Style) -> None:          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
| |        0x00000199F214EBA0>                                              | |
| | text = '\U0001f539 '                                                            | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
|                                                                             |
|    16                                                                       |
|    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
|    18     def encode(self, input, final=False):                             |
| >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
|    20                                                                       |
|    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
|    22     def decode(self, input, final=False):                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | final = False                                                           | |
| | input = '\U0001f539 '                                                           | |
| |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
| |         0x00000199ED60BE90>                                             | |
| +-------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------+
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
position 0: character maps to <undefined>

During handling of the above exception, another exception occurred:

+--------------------- Traceback (most recent call last) ---------------------+
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\commands\session |
| .py:207 in run                                                              |
|                                                                             |
|   204                                                                       |
|   205     mode = args.mode or ("backtest" if args.backtest > 0 else "single |
|   206                                                                       |
| > 207     append_event(                                                     |
|   208         {                                                             |
|   209             "event": "SYSTEM_STARTUP",                                |
|   210             "mode": mode,                                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    args = namespace(source='mock', symbol='BTCUSDT',    | |
| |                           interval='1m', limit=200, fees_bps=2.0,       | |
| |                           slip_bps=0.5, backtest=0,                     | |
| |                           backtest_mode='position', mode='selftest',    | |
| |                           duration=10, once=False,                      | |
| |                           execution_mode='paper', risk_pct=1.0,         | |
| |                           stop_bps=30.0, tp_r=1.5, max_leverage=1.0,    | |
| |                           intrabar_mode='conservative',                 | |
| |                           validate_splits=5, validate_train=600,        | |
| |                           validate_test=200,                            | |
| |                           grid='sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0à | |
| |                           validate_max_candidates=200, dry_run=False,   | |
| |                           show=False, strategy='default',               | |
| |                           async_mode=True, stale_timeout=120,           | |
| |                           execution_latency_ms=200, dashboard=False,    | |
| |                           preflight=False, replay=None, config=None,    | |
| |                           quiet=False, verbose=False)                   | |
| |              async_mode = True                                          | |
| |                  atexit = <module 'atexit' (built-in)>                  | |
| |                backtest = 0                                             | |
| |           backtest_mode = 'position'                                    | |
| |                  config = None                                          | |
| |               dashboard = False                                         | |
| |                 dry_run = False                                         | |
| |                duration = 10                                            | |
| |    execution_latency_ms = 200                                           | |
| |          execution_mode = 'paper'                                       | |
| |                fees_bps = 2.0                                           | |
| |                    grid = 'sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0'      | |
| |                interval = '1m'                                          | |
| |           intrabar_mode = 'conservative'                                | |
| |                   limit = 200                                           | |
| |                    lock = <laptop_agents.core.lock_manager.LockManager  | |
| |                           object at 0x00000199F288FF50>                 | |
| |            max_leverage = 1.0                                           | |
| |                    mode = 'selftest'                                    | |
| |                    once = False                                         | |
| |               preflight = False                                         | |
| |                   quiet = False                                         | |
| |                  replay = None                                          | |
| |                risk_pct = 1.0                                           | |
| |          session_config = SessionConfig(                                | |
| |                               symbol='BTCUSDT',                         | |
| |                               interval='1m',                            | |
| |                               source='mock',                            | |
| |                               duration=10,                              | |
| |                               execution_mode='paper',                   | |
| |                               fees_bps=2.0,                             | |
| |                               slip_bps=0.5,                             | |
| |                               dry_run=False,                            | |
| |                               kill_switch=False                         | |
| |                           )                                             | |
| |                    show = False                                         | |
| |                slip_bps = 0.5                                           | |
| |                  source = 'mock'                                        | |
| |           stale_timeout = 120                                           | |
| |                stop_bps = 30.0                                          | |
| |                strategy = 'default'                                     | |
| |                  symbol = 'BTCUSDT'                                     | |
| |                    tp_r = 1.5                                           | |
| | validate_max_candidates = 200                                           | |
| |         validate_splits = 5                                             | |
| |           validate_test = 200                                           | |
| |          validate_train = 600                                           | |
| |                 verbose = False                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\events.py:5 |
| 2 in append_event                                                           |
|                                                                             |
|   49                                                                        |
|   50     obj.setdefault("timestamp", utc_ts())                              |
|   51     event_name = obj.get("event", "UnnamedEvent")                      |
| > 52     logger.info(f"EVENT: {event_name}", obj)                           |
|   53                                                                        |
|   54     if paper:                                                          |
|   55         PAPER_DIR.mkdir(parents=True, exist_ok=True)  # Ensure parents |
|                                                                             |
| +----------------------------- locals -----------------------------+        |
| |    content = {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'selftest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  }                                               |        |
| |              }                                                   |        |
| |   event_id = '712c2b61b0405a8b4fe37ca994a175b0'                  |        |
| | event_name = 'SYSTEM_STARTUP'                                    |        |
| |        obj = {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'selftest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  },                                              |        |
| |                  'event_id': '712c2b61b0405a8b4fe37ca994a175b0', |        |
| |                  'timestamp': '2026-01-25T01:25:58.028854Z'      |        |
| |              }                                                   |        |
| |      paper = True                                                |        |
| +------------------------------------------------------------------+        |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1539 in info              |
|                                                                             |
|   1536         logger.info("Houston, we have a %s", "notable problem", exc_ |
|   1537         """                                                          |
|   1538         if self.isEnabledFor(INFO):                                  |
| > 1539             self._log(INFO, msg, args, **kwargs)                     |
|   1540                                                                      |
|   1541     def warning(self, msg, *args, **kwargs):                         |
|   1542         """                                                          |
|                                                                             |
| +----------------------------- locals -----------------------------+        |
| |   args = (                                                       |        |
| |              {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'selftest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  },                                              |        |
| |                  'event_id': '712c2b61b0405a8b4fe37ca994a175b0', |        |
| |                  'timestamp': '2026-01-25T01:25:58.028854Z'      |        |
| |              },                                                  |        |
| |          )                                                       |        |
| | kwargs = {}                                                      |        |
| |    msg = 'EVENT: SYSTEM_STARTUP'                                 |        |
| |   self = <Logger btc_agents (INFO)>                              |        |
| +------------------------------------------------------------------+        |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1684 in _log              |
|                                                                             |
|   1681                 exc_info = sys.exc_info()                            |
|   1682         record = self.makeRecord(self.name, level, fn, lno, msg, arg |
|   1683                                  exc_info, func, extra, sinfo)       |
| > 1684         self.handle(record)                                          |
|   1685                                                                      |
|   1686     def handle(self, record):                                        |
|   1687         """                                                          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |       args = (                                                          | |
| |                  {                                                      | |
| |                      'event': 'SYSTEM_STARTUP',                         | |
| |                      'mode': 'selftest',                                | |
| |                      'config': {                                        | |
| |                          'symbol': 'BTCUSDT',                           | |
| |                          'interval': '1m',                              | |
| |                          'source': 'mock',                              | |
| |                          'duration': 10,                                | |
| |                          'execution_mode': 'paper',                     | |
| |                          'fees_bps': 2.0,                               | |
| |                          'slip_bps': 0.5,                               | |
| |                          'dry_run': False,                              | |
| |                          'kill_switch': False                           | |
| |                      },                                                 | |
| |                      'event_id': '712c2b61b0405a8b4fe37ca994a175b0',    | |
| |                      'timestamp': '2026-01-25T01:25:58.028854Z'         | |
| |                  },                                                     | |
| |              )                                                          | |
| |   exc_info = None                                                       | |
| |      extra = None                                                       | |
| |         fn = 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\src\\laptoà | |
| |       func = 'append_event'                                             | |
| |      level = 20                                                         | |
| |        lno = 52                                                         | |
| |        msg = 'EVENT: SYSTEM_STARTUP'                                    | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <Logger btc_agents (INFO)>                                 | |
| |      sinfo = None                                                       | |
| | stack_info = False                                                      | |
| | stacklevel = 1                                                          | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1700 in handle            |
|                                                                             |
|   1697             return                                                   |
|   1698         if isinstance(maybe_record, LogRecord):                      |
|   1699             record = maybe_record                                    |
| > 1700         self.callHandlers(record)                                    |
|   1701                                                                      |
|   1702     def addHandler(self, hdlr):                                      |
|   1703         """                                                          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | maybe_record = <LogRecord: btc_agents, 20,                              | |
| |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
| |                52, "EVENT: SYSTEM_STARTUP">                             | |
| |       record = <LogRecord: btc_agents, 20,                              | |
| |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
| |                52, "EVENT: SYSTEM_STARTUP">                             | |
| |         self = <Logger btc_agents (INFO)>                               | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1762 in callHandlers      |
|                                                                             |
|   1759             for hdlr in c.handlers:                                  |
|   1760                 found = found + 1                                    |
|   1761                 if record.levelno >= hdlr.level:                     |
| > 1762                     hdlr.handle(record)                              |
|   1763             if not c.propagate:                                      |
|   1764                 c = None    #break out                               |
|   1765             else:                                                    |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |      c = <Logger btc_agents (INFO)>                                     | |
| |  found = 3                                                              | |
| |   hdlr = <EventPanelHandler (INFO)>                                     | |
| | record = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |   self = <Logger btc_agents (INFO)>                                     | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1028 in handle            |
|                                                                             |
|   1025         if rv:                                                       |
|   1026             self.acquire()                                           |
|   1027             try:                                                     |
| > 1028                 self.emit(record)                                    |
|   1029             finally:                                                 |
|   1030                 self.release()                                       |
|   1031         return rv                                                    |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | record = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |     rv = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |   self = <EventPanelHandler (INFO)>                                     | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
| 07 in emit                                                                  |
|                                                                             |
|   204                 )                                                     |
|   205         except Exception as e:                                        |
|   206             # Fallback for panel errors                               |
| > 207             self.console.print(                                       |
|   208                 f"[dim](Panel Format Error: {e})[/dim] {record.getMes |
|   209             )                                                         |
|   210                                                                       |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | event_name = 'SYSTEM_STARTUP'                                           | |
| |       meta = {                                                          | |
| |                  'event': 'SYSTEM_STARTUP',                             | |
| |                  'mode': 'selftest',                                    | |
| |                  'config': {                                            | |
| |                      'symbol': 'BTCUSDT',                               | |
| |                      'interval': '1m',                                  | |
| |                      'source': 'mock',                                  | |
| |                      'duration': 10,                                    | |
| |                      'execution_mode': 'paper',                         | |
| |                      'fees_bps': 2.0,                                   | |
| |                      'slip_bps': 0.5,                                   | |
| |                      'dry_run': False,                                  | |
| |                      'kill_switch': False                               | |
| |                  },                                                     | |
| |                  'event_id': '***',                                     | |
| |                  'timestamp': '2026-01-25T01:25:58.028854Z'             | |
| |              }                                                          | |
| |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]selftest  | |
| |              [dim]config=[/dim]{'sym"+169                               | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <EventPanelHandler (INFO)>                                 | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:1678 in print                                                            |
|                                                                             |
|   1675                 overflow = "ignore"                                  |
|   1676             crop = False                                             |
|   1677         render_hooks = self._render_hooks[:]                         |
| > 1678         with self:                                                   |
|   1679             renderables = self._collect_renderables(                 |
|   1680                 objects,                                             |
|   1681                 sep,                                                 |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer_extend = <built-in method extend of list object at              | |
| |                  0x00000199F0D2CC80>                                    | |
| |           crop = True                                                   | |
| |          emoji = None                                                   | |
| |            end = '\n'                                                   | |
| |         extend = <built-in method extend of list object at              | |
| |                  0x00000199F28A8680>                                    | |
| |         height = None                                                   | |
| |      highlight = None                                                   | |
| |        justify = None                                                   | |
| |           line = [                                                      | |
| |                      Segment('position ', Style(dim=True)),             | |
| |                      Segment(                                           | |
| |                          '0',                                           | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': character maps to ', Style(dim=True)),  | |
| |                      Segment('<', Style(bold=True, dim=True)),          | |
| |                      Segment(                                           | |
| |                          'undefined',                                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_magenta',                      | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=13                              | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True                                   | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('>', Style(bold=True, dim=True)),          | |
| |                      Segment(')', Style(bold=True, dim=True)),          | |
| |                      Segment(' EVENT: SYSTEM_STARTUP', Style()),        | |
| |                      Segment('\n')                                      | |
| |                  ]                                                      | |
| |         markup = None                                                   | |
| | new_line_start = False                                                  | |
| |   new_segments = [                                                      | |
| |                      Segment('(', Style(bold=True, dim=True)),          | |
| |                      Segment('Panel Format Error: ', Style(dim=True)),  | |
| |                      Segment(                                           | |
| |                          "'charmap'",                                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(                                           | |
| |                          " codec can't encode character ",              | |
| |                          Style(dim=True)                                | |
| |                      ),                                                 | |
| |                      Segment(                                           | |
| |                          "'\\U0001f539'",                               | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' in ', Style(dim=True)),                  | |
| |                      Segment('\n', Style()),                            | |
| |                      Segment('position ', Style(dim=True)),             | |
| |                      Segment(                                           | |
| |                          '0',                                           | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': character maps to ', Style(dim=True)),  | |
| |                      ... +6                                             | |
| |                  ]                                                      | |
| |        no_wrap = None                                                   | |
| |        objects = (                                                      | |
| |                      "[dim](Panel Format Error: 'charmap' codec can't   | |
| |                  encode character '\\U0001f539' in"+71,                 | |
| |                  )                                                      | |
| |       overflow = None                                                   | |
| |         render = <bound method Console.render of <console width=79      | |
| |                  None>>                                                 | |
| |   render_hooks = []                                                     | |
| | render_options = ConsoleOptions(                                        | |
| |                      size=ConsoleDimensions(width=79, height=25),       | |
| |                      legacy_windows=True,                               | |
| |                      min_width=1,                                       | |
| |                      max_width=79,                                      | |
| |                      is_terminal=False,                                 | |
| |                      encoding='cp1252',                                 | |
| |                      max_height=25,                                     | |
| |                      justify=None,                                      | |
| |                      overflow=None,                                     | |
| |                      no_wrap=None,                                      | |
| |                      highlight=None,                                    | |
| |                      markup=None,                                       | |
| |                      height=None                                        | |
| |                  )                                                      | |
| |     renderable = <text "(Panel Format Error: 'charmap' codec can't      | |
| |                  encode character '\\U0001f539' in position 0:          | |
| |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
| |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
| |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
| |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
| |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
| |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
| |                  'dim')] ''>                                            | |
| |    renderables = [                                                      | |
| |                      <text "(Panel Format Error: 'charmap' codec can't  | |
| |                  encode character '\\U0001f539' in position 0:          | |
| |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
| |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
| |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
| |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
| |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
| |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
| |                  'dim')] ''>                                            | |
| |                  ]                                                      | |
| |           self = <console width=79 None>                                | |
| |            sep = ' '                                                    | |
| |      soft_wrap = False                                                  | |
| |          style = None                                                   | |
| |          width = None                                                   | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:864 in __exit__                                                          |
|                                                                             |
|    861                                                                      |
|    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
|    863         """Exit buffer context."""                                   |
| >  864         self._exit_buffer()                                          |
|    865                                                                      |
|    866     def begin_capture(self) -> None:                                 |
|    867         """Begin capturing console output. Call :meth:`end_capture`  |
|                                                                             |
| +-------------- locals ---------------+                                     |
| |  exc_type = None                    |                                     |
| | exc_value = None                    |                                     |
| |      self = <console width=79 None> |                                     |
| | traceback = None                    |                                     |
| +-------------------------------------+                                     |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:822 in _exit_buffer                                                      |
|                                                                             |
|    819     def _exit_buffer(self) -> None:                                  |
|    820         """Leave buffer context, and render content if required."""  |
|    821         self._buffer_index -= 1                                      |
| >  822         self._check_buffer()                                         |
|    823                                                                      |
|    824     def set_live(self, live: "Live") -> None:                        |
|    825         """Set Live instance. Used by Live context manager.          |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2019 in _check_buffer                                                    |
|                                                                             |
|   2016             return                                                   |
|   2017                                                                      |
|   2018         try:                                                         |
| > 2019             self._write_buffer()                                     |
|   2020         except BrokenPipeError:                                      |
|   2021             self.on_broken_pipe()                                    |
|   2022                                                                      |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2055 in _write_buffer                                                    |
|                                                                             |
|   2052                             if self.no_color and self._color_system: |
|   2053                                 buffer = list(Segment.remove_color(b |
|   2054                                                                      |
| > 2055                             legacy_windows_render(buffer, LegacyWind |
|   2056                         else:                                        |
|   2057                             # Either a non-std stream on legacy Wind |
|   2058                             text = self._render_buffer(self._buffer[ |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    buffer = [                                           | |
| |                                 Segment('\U0001f539 ', Style()),                | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP           ',        | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'cyan',                     | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=6                    | |
| |                                         ),                              | |
| |                                         bold=True                       | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'event',                            | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP',                   | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'mode',                             | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'selftest',                         | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 ... +60                                 | |
| |                             ]                                           | |
| |                    fileno = 1                                           | |
| |                      self = <console width=79 None>                     | |
| | use_legacy_windows_render = True                                        | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
| _renderer.py:19 in legacy_windows_render                                    |
|                                                                             |
|   16             if style:                                                  |
|   17                 term.write_styled(text, style)                         |
|   18             else:                                                      |
| > 19                 term.write_text(text)                                  |
|   20         else:                                                          |
|   21             control_codes: Sequence[ControlCode] = control             |
|   22             for control_code in control_codes:                         |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer = [                                                             | |
| |               Segment('\U0001f539 ', Style()),                                  | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP           ',                          | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'cyan',                                       | |
| |                           ColorType.STANDARD,                           | |
| |                           number=6                                      | |
| |                       ),                                                | |
| |                       bold=True                                         | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'event',                                              | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP',                                     | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'mode',                                               | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'selftest',                                           | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               ... +60                                                   | |
| |           ]                                                             | |
| | control = None                                                          | |
| |   style = Style()                                                       | |
| |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
| |           0x00000199F28A0500>                                           | |
| |    text = '\U0001f539 '                                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
| onsole.py:402 in write_text                                                 |
|                                                                             |
|   399         Args:                                                         |
|   400             text (str): The text to write to the console              |
|   401         """                                                           |
| > 402         self.write(text)                                              |
|   403         self.flush()                                                  |
|   404                                                                       |
|   405     def write_styled(self, text: str, style: Style) -> None:          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
| |        0x00000199F28A0500>                                              | |
| | text = '\U0001f539 '                                                            | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
|                                                                             |
|    16                                                                       |
|    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
|    18     def encode(self, input, final=False):                             |
| >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
|    20                                                                       |
|    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
|    22     def decode(self, input, final=False):                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | final = False                                                           | |
| | input = '\U0001f539 '                                                           | |
| |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
| |         0x00000199ED60BE90>                                             | |
| +-------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------+
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
position 0: character maps to <undefined>

________________________ test_backtest_reproducibility ________________________

    def test_backtest_reproducibility():
        print("2. Testing --mode backtest artifacts...")
    
        # Run small backtest
        result = run_command(
            [
                "-m",
                "laptop_agents",
                "run",
                "--mode",
                "backtest",
                "--source",
                "mock",
                "--backtest",
                "100",
            ]
        )
    
        if result.returncode != 0:
            print("[FAIL] Backtest returned non-zero exit code.")
            print("STDERR:", result.stderr)
>           assert result.returncode == 0, f"Backtest failed with stderr: {result.stderr}"
E           AssertionError: Backtest failed with stderr: +--------------------- Traceback (most recent call last) ---------------------+
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
E             | 02 in emit                                                                  |
E             |                                                                             |
E             |   199                         if k not in ["timestamp", "event_id"]         |
E             |   200                     ]                                                 |
E             |   201                 )                                                     |
E             | > 202                 self.console.print(                                   |
E             |   203                     f"\U0001f539 [bold cyan]{event_name: <25}[/bold cyan] {me |
E             |   204                 )                                                     |
E             |   205         except Exception as e:                                        |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | event_name = 'SYSTEM_STARTUP'                                           | |
E             | |       meta = {                                                          | |
E             | |                  'event': 'SYSTEM_STARTUP',                             | |
E             | |                  'mode': 'backtest',                                    | |
E             | |                  'config': {                                            | |
E             | |                      'symbol': 'BTCUSDT',                               | |
E             | |                      'interval': '1m',                                  | |
E             | |                      'source': 'mock',                                  | |
E             | |                      'duration': 10,                                    | |
E             | |                      'execution_mode': 'paper',                         | |
E             | |                      'fees_bps': 2.0,                                   | |
E             | |                      'slip_bps': 0.5,                                   | |
E             | |                      'dry_run': False,                                  | |
E             | |                      'kill_switch': False                               | |
E             | |                  },                                                     | |
E             | |                  'event_id': '***',                                     | |
E             | |                  'timestamp': '2026-01-25T01:26:00.136253Z'             | |
E             | |              }                                                          | |
E             | |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]backtest  | |
E             | |              [dim]config=[/dim]{'sym"+169                               | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <EventPanelHandler (INFO)>                                 | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:1678 in print                                                            |
E             |                                                                             |
E             |   1675                 overflow = "ignore"                                  |
E             |   1676             crop = False                                             |
E             |   1677         render_hooks = self._render_hooks[:]                         |
E             | > 1678         with self:                                                   |
E             |   1679             renderables = self._collect_renderables(                 |
E             |   1680                 objects,                                             |
E             |   1681                 sep,                                                 |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer_extend = <built-in method extend of list object at              | |
E             | |                  0x000001C2C60AC300>                                    | |
E             | |           crop = True                                                   | |
E             | |          emoji = None                                                   | |
E             | |            end = '\n'                                                   | |
E             | |         extend = <built-in method extend of list object at              | |
E             | |                  0x000001C2C7C49880>                                    | |
E             | |         height = None                                                   | |
E             | |      highlight = None                                                   | |
E             | |        justify = None                                                   | |
E             | |           line = [                                                      | |
E             | |                      Segment(                                           | |
E             | |                          'False',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_red',                          | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=9                               | |
E             | |                              ),                                         | |
E             | |                              italic=True                                | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(', ', Style()),                            | |
E             | |                      Segment(                                           | |
E             | |                          "'kill_switch'",                               | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': ', Style()),                            | |
E             | |                      Segment(                                           | |
E             | |                          'False',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_red',                          | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=9                               | |
E             | |                              ),                                         | |
E             | |                              italic=True                                | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('}', Style(bold=True)),                    | |
E             | |                      Segment('\n')                                      | |
E             | |                  ]                                                      | |
E             | |         markup = None                                                   | |
E             | | new_line_start = False                                                  | |
E             | |   new_segments = [                                                      | |
E             | |                      Segment('\U0001f539 ', Style()),                           | |
E             | |                      Segment(                                           | |
E             | |                          'SYSTEM_STARTUP           ',                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True                                  | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' ', Style()),                             | |
E             | |                      Segment(                                           | |
E             | |                          'event',                                       | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'yellow',                              | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=3                               | |
E             | |                              ),                                         | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('=', Style(dim=True)),                     | |
E             | |                      Segment(                                           | |
E             | |                          'SYSTEM_STARTUP',                              | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'magenta',                             | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=5                               | |
E             | |                              ),                                         | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' ', Style()),                             | |
E             | |                      Segment(                                           | |
E             | |                          'mode',                                        | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'yellow',                              | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=3                               | |
E             | |                              ),                                         | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('=', Style(dim=True)),                     | |
E             | |                      Segment(                                           | |
E             | |                          'backtest',                                    | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'magenta',                             | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=5                               | |
E             | |                              ),                                         | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      ... +41                                            | |
E             | |                  ]                                                      | |
E             | |        no_wrap = None                                                   | |
E             | |        objects = (                                                      | |
E             | |                      '\U0001f539 [bold cyan]SYSTEM_STARTUP           [/bold     | |
E             | |                  cyan] [dim]event=[/dim]SYSTEM_START'+220,              | |
E             | |                  )                                                      | |
E             | |       overflow = None                                                   | |
E             | |         render = <bound method Console.render of <console width=79      | |
E             | |                  None>>                                                 | |
E             | |   render_hooks = []                                                     | |
E             | | render_options = ConsoleOptions(                                        | |
E             | |                      size=ConsoleDimensions(width=79, height=25),       | |
E             | |                      legacy_windows=True,                               | |
E             | |                      min_width=1,                                       | |
E             | |                      max_width=79,                                      | |
E             | |                      is_terminal=False,                                 | |
E             | |                      encoding='cp1252',                                 | |
E             | |                      max_height=25,                                     | |
E             | |                      justify=None,                                      | |
E             | |                      overflow=None,                                     | |
E             | |                      no_wrap=None,                                      | |
E             | |                      highlight=None,                                    | |
E             | |                      markup=None,                                       | |
E             | |                      height=None                                        | |
E             | |                  )                                                      | |
E             | |     renderable = <text "\U0001f539 SYSTEM_STARTUP                               | |
E             | |                  event=SYSTEM_STARTUP mode=backtest config={'symbol':   | |
E             | |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
E             | |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
E             | |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
E             | |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
E             | |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
E             | |                  'repr.attrib_name'), Span(54, 62,                      | |
E             | |                  'repr.attrib_value'), Span(63, 69,                     | |
E             | |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
E             | |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
E             | |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
E             | |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
E             | |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
E             | |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
E             | |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
E             | |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
E             | |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
E             | |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
E             | |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
E             | |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
E             | |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
E             | |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
E             | |                  ''>                                                    | |
E             | |    renderables = [                                                      | |
E             | |                      <text "\U0001f539 SYSTEM_STARTUP                           | |
E             | |                  event=SYSTEM_STARTUP mode=backtest config={'symbol':   | |
E             | |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
E             | |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
E             | |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
E             | |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
E             | |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
E             | |                  'repr.attrib_name'), Span(54, 62,                      | |
E             | |                  'repr.attrib_value'), Span(63, 69,                     | |
E             | |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
E             | |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
E             | |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
E             | |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
E             | |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
E             | |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
E             | |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
E             | |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
E             | |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
E             | |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
E             | |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
E             | |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
E             | |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
E             | |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
E             | |                  ''>                                                    | |
E             | |                  ]                                                      | |
E             | |           self = <console width=79 None>                                | |
E             | |            sep = ' '                                                    | |
E             | |      soft_wrap = False                                                  | |
E             | |          style = None                                                   | |
E             | |          width = None                                                   | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:864 in __exit__                                                          |
E             |                                                                             |
E             |    861                                                                      |
E             |    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
E             |    863         """Exit buffer context."""                                   |
E             | >  864         self._exit_buffer()                                          |
E             |    865                                                                      |
E             |    866     def begin_capture(self) -> None:                                 |
E             |    867         """Begin capturing console output. Call :meth:`end_capture`  |
E             |                                                                             |
E             | +-------------- locals ---------------+                                     |
E             | |  exc_type = None                    |                                     |
E             | | exc_value = None                    |                                     |
E             | |      self = <console width=79 None> |                                     |
E             | | traceback = None                    |                                     |
E             | +-------------------------------------+                                     |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:822 in _exit_buffer                                                      |
E             |                                                                             |
E             |    819     def _exit_buffer(self) -> None:                                  |
E             |    820         """Leave buffer context, and render content if required."""  |
E             |    821         self._buffer_index -= 1                                      |
E             | >  822         self._check_buffer()                                         |
E             |    823                                                                      |
E             |    824     def set_live(self, live: "Live") -> None:                        |
E             |    825         """Set Live instance. Used by Live context manager.          |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2019 in _check_buffer                                                    |
E             |                                                                             |
E             |   2016             return                                                   |
E             |   2017                                                                      |
E             |   2018         try:                                                         |
E             | > 2019             self._write_buffer()                                     |
E             |   2020         except BrokenPipeError:                                      |
E             |   2021             self.on_broken_pipe()                                    |
E             |   2022                                                                      |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2055 in _write_buffer                                                    |
E             |                                                                             |
E             |   2052                             if self.no_color and self._color_system: |
E             |   2053                                 buffer = list(Segment.remove_color(b |
E             |   2054                                                                      |
E             | > 2055                             legacy_windows_render(buffer, LegacyWind |
E             |   2056                         else:                                        |
E             |   2057                             # Either a non-std stream on legacy Wind |
E             |   2058                             text = self._render_buffer(self._buffer[ |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    buffer = [                                           | |
E             | |                                 Segment('\U0001f539 ', Style()),                | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP           ',        | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'cyan',                     | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=6                    | |
E             | |                                         ),                              | |
E             | |                                         bold=True                       | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'event',                            | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP',                   | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'mode',                             | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'backtest',                         | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 ... +44                                 | |
E             | |                             ]                                           | |
E             | |                    fileno = 1                                           | |
E             | |                      self = <console width=79 None>                     | |
E             | | use_legacy_windows_render = True                                        | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
E             | _renderer.py:19 in legacy_windows_render                                    |
E             |                                                                             |
E             |   16             if style:                                                  |
E             |   17                 term.write_styled(text, style)                         |
E             |   18             else:                                                      |
E             | > 19                 term.write_text(text)                                  |
E             |   20         else:                                                          |
E             |   21             control_codes: Sequence[ControlCode] = control             |
E             |   22             for control_code in control_codes:                         |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer = [                                                             | |
E             | |               Segment('\U0001f539 ', Style()),                                  | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP           ',                          | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'cyan',                                       | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=6                                      | |
E             | |                       ),                                                | |
E             | |                       bold=True                                         | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'event',                                              | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP',                                     | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'mode',                                               | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'backtest',                                           | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               ... +44                                                   | |
E             | |           ]                                                             | |
E             | | control = None                                                          | |
E             | |   style = Style()                                                       | |
E             | |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
E             | |           0x000001C2C755EE70>                                           | |
E             | |    text = '\U0001f539 '                                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
E             | onsole.py:402 in write_text                                                 |
E             |                                                                             |
E             |   399         Args:                                                         |
E             |   400             text (str): The text to write to the console              |
E             |   401         """                                                           |
E             | > 402         self.write(text)                                              |
E             |   403         self.flush()                                                  |
E             |   404                                                                       |
E             |   405     def write_styled(self, text: str, style: Style) -> None:          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
E             | |        0x000001C2C755EE70>                                              | |
E             | | text = '\U0001f539 '                                                            | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
E             |                                                                             |
E             |    16                                                                       |
E             |    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
E             |    18     def encode(self, input, final=False):                             |
E             | >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
E             |    20                                                                       |
E             |    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
E             |    22     def decode(self, input, final=False):                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | final = False                                                           | |
E             | | input = '\U0001f539 '                                                           | |
E             | |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
E             | |         0x000001C2C295BEC0>                                             | |
E             | +-------------------------------------------------------------------------+ |
E             +-----------------------------------------------------------------------------+
E             UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
E             position 0: character maps to <undefined>
E             
E             During handling of the above exception, another exception occurred:
E             
E             +--------------------- Traceback (most recent call last) ---------------------+
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\commands\session |
E             | .py:207 in run                                                              |
E             |                                                                             |
E             |   204                                                                       |
E             |   205     mode = args.mode or ("backtest" if args.backtest > 0 else "single |
E             |   206                                                                       |
E             | > 207     append_event(                                                     |
E             |   208         {                                                             |
E             |   209             "event": "SYSTEM_STARTUP",                                |
E             |   210             "mode": mode,                                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    args = namespace(source='mock', symbol='BTCUSDT',    | |
E             | |                           interval='1m', limit=200, fees_bps=2.0,       | |
E             | |                           slip_bps=0.5, backtest=100,                   | |
E             | |                           backtest_mode='position', mode='backtest',    | |
E             | |                           duration=10, once=False,                      | |
E             | |                           execution_mode='paper', risk_pct=1.0,         | |
E             | |                           stop_bps=30.0, tp_r=1.5, max_leverage=1.0,    | |
E             | |                           intrabar_mode='conservative',                 | |
E             | |                           validate_splits=5, validate_train=600,        | |
E             | |                           validate_test=200,                            | |
E             | |                           grid='sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0à | |
E             | |                           validate_max_candidates=200, dry_run=False,   | |
E             | |                           show=False, strategy='default',               | |
E             | |                           async_mode=True, stale_timeout=120,           | |
E             | |                           execution_latency_ms=200, dashboard=False,    | |
E             | |                           preflight=False, replay=None, config=None,    | |
E             | |                           quiet=False, verbose=False)                   | |
E             | |              async_mode = True                                          | |
E             | |                  atexit = <module 'atexit' (built-in)>                  | |
E             | |                backtest = 100                                           | |
E             | |           backtest_mode = 'position'                                    | |
E             | |                  config = None                                          | |
E             | |               dashboard = False                                         | |
E             | |                 dry_run = False                                         | |
E             | |                duration = 10                                            | |
E             | |    execution_latency_ms = 200                                           | |
E             | |          execution_mode = 'paper'                                       | |
E             | |                fees_bps = 2.0                                           | |
E             | |                    grid = 'sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0'      | |
E             | |                interval = '1m'                                          | |
E             | |           intrabar_mode = 'conservative'                                | |
E             | |                   limit = 200                                           | |
E             | |                    lock = <laptop_agents.core.lock_manager.LockManager  | |
E             | |                           object at 0x000001C2C7C2FFE0>                 | |
E             | |            max_leverage = 1.0                                           | |
E             | |                    mode = 'backtest'                                    | |
E             | |                    once = False                                         | |
E             | |               preflight = False                                         | |
E             | |                   quiet = False                                         | |
E             | |                  replay = None                                          | |
E             | |                risk_pct = 1.0                                           | |
E             | |          session_config = SessionConfig(                                | |
E             | |                               symbol='BTCUSDT',                         | |
E             | |                               interval='1m',                            | |
E             | |                               source='mock',                            | |
E             | |                               duration=10,                              | |
E             | |                               execution_mode='paper',                   | |
E             | |                               fees_bps=2.0,                             | |
E             | |                               slip_bps=0.5,                             | |
E             | |                               dry_run=False,                            | |
E             | |                               kill_switch=False                         | |
E             | |                           )                                             | |
E             | |                    show = False                                         | |
E             | |                slip_bps = 0.5                                           | |
E             | |                  source = 'mock'                                        | |
E             | |           stale_timeout = 120                                           | |
E             | |                stop_bps = 30.0                                          | |
E             | |                strategy = 'default'                                     | |
E             | |                  symbol = 'BTCUSDT'                                     | |
E             | |                    tp_r = 1.5                                           | |
E             | | validate_max_candidates = 200                                           | |
E             | |         validate_splits = 5                                             | |
E             | |           validate_test = 200                                           | |
E             | |          validate_train = 600                                           | |
E             | |                 verbose = False                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\events.py:5 |
E             | 2 in append_event                                                           |
E             |                                                                             |
E             |   49                                                                        |
E             |   50     obj.setdefault("timestamp", utc_ts())                              |
E             |   51     event_name = obj.get("event", "UnnamedEvent")                      |
E             | > 52     logger.info(f"EVENT: {event_name}", obj)                           |
E             |   53                                                                        |
E             |   54     if paper:                                                          |
E             |   55         PAPER_DIR.mkdir(parents=True, exist_ok=True)  # Ensure parents |
E             |                                                                             |
E             | +----------------------------- locals -----------------------------+        |
E             | |    content = {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'backtest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  }                                               |        |
E             | |              }                                                   |        |
E             | |   event_id = '3992cb3cb53b443218ec8808fb730640'                  |        |
E             | | event_name = 'SYSTEM_STARTUP'                                    |        |
E             | |        obj = {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'backtest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  },                                              |        |
E             | |                  'event_id': '3992cb3cb53b443218ec8808fb730640', |        |
E             | |                  'timestamp': '2026-01-25T01:26:00.136253Z'      |        |
E             | |              }                                                   |        |
E             | |      paper = True                                                |        |
E             | +------------------------------------------------------------------+        |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1539 in info              |
E             |                                                                             |
E             |   1536         logger.info("Houston, we have a %s", "notable problem", exc_ |
E             |   1537         """                                                          |
E             |   1538         if self.isEnabledFor(INFO):                                  |
E             | > 1539             self._log(INFO, msg, args, **kwargs)                     |
E             |   1540                                                                      |
E             |   1541     def warning(self, msg, *args, **kwargs):                         |
E             |   1542         """                                                          |
E             |                                                                             |
E             | +----------------------------- locals -----------------------------+        |
E             | |   args = (                                                       |        |
E             | |              {                                                   |        |
E             | |                  'event': 'SYSTEM_STARTUP',                      |        |
E             | |                  'mode': 'backtest',                             |        |
E             | |                  'config': {                                     |        |
E             | |                      'symbol': 'BTCUSDT',                        |        |
E             | |                      'interval': '1m',                           |        |
E             | |                      'source': 'mock',                           |        |
E             | |                      'duration': 10,                             |        |
E             | |                      'execution_mode': 'paper',                  |        |
E             | |                      'fees_bps': 2.0,                            |        |
E             | |                      'slip_bps': 0.5,                            |        |
E             | |                      'dry_run': False,                           |        |
E             | |                      'kill_switch': False                        |        |
E             | |                  },                                              |        |
E             | |                  'event_id': '3992cb3cb53b443218ec8808fb730640', |        |
E             | |                  'timestamp': '2026-01-25T01:26:00.136253Z'      |        |
E             | |              },                                                  |        |
E             | |          )                                                       |        |
E             | | kwargs = {}                                                      |        |
E             | |    msg = 'EVENT: SYSTEM_STARTUP'                                 |        |
E             | |   self = <Logger btc_agents (INFO)>                              |        |
E             | +------------------------------------------------------------------+        |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1684 in _log              |
E             |                                                                             |
E             |   1681                 exc_info = sys.exc_info()                            |
E             |   1682         record = self.makeRecord(self.name, level, fn, lno, msg, arg |
E             |   1683                                  exc_info, func, extra, sinfo)       |
E             | > 1684         self.handle(record)                                          |
E             |   1685                                                                      |
E             |   1686     def handle(self, record):                                        |
E             |   1687         """                                                          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |       args = (                                                          | |
E             | |                  {                                                      | |
E             | |                      'event': 'SYSTEM_STARTUP',                         | |
E             | |                      'mode': 'backtest',                                | |
E             | |                      'config': {                                        | |
E             | |                          'symbol': 'BTCUSDT',                           | |
E             | |                          'interval': '1m',                              | |
E             | |                          'source': 'mock',                              | |
E             | |                          'duration': 10,                                | |
E             | |                          'execution_mode': 'paper',                     | |
E             | |                          'fees_bps': 2.0,                               | |
E             | |                          'slip_bps': 0.5,                               | |
E             | |                          'dry_run': False,                              | |
E             | |                          'kill_switch': False                           | |
E             | |                      },                                                 | |
E             | |                      'event_id': '3992cb3cb53b443218ec8808fb730640',    | |
E             | |                      'timestamp': '2026-01-25T01:26:00.136253Z'         | |
E             | |                  },                                                     | |
E             | |              )                                                          | |
E             | |   exc_info = None                                                       | |
E             | |      extra = None                                                       | |
E             | |         fn = 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\src\\laptoà | |
E             | |       func = 'append_event'                                             | |
E             | |      level = 20                                                         | |
E             | |        lno = 52                                                         | |
E             | |        msg = 'EVENT: SYSTEM_STARTUP'                                    | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <Logger btc_agents (INFO)>                                 | |
E             | |      sinfo = None                                                       | |
E             | | stack_info = False                                                      | |
E             | | stacklevel = 1                                                          | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1700 in handle            |
E             |                                                                             |
E             |   1697             return                                                   |
E             |   1698         if isinstance(maybe_record, LogRecord):                      |
E             |   1699             record = maybe_record                                    |
E             | > 1700         self.callHandlers(record)                                    |
E             |   1701                                                                      |
E             |   1702     def addHandler(self, hdlr):                                      |
E             |   1703         """                                                          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | maybe_record = <LogRecord: btc_agents, 20,                              | |
E             | |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
E             | |                52, "EVENT: SYSTEM_STARTUP">                             | |
E             | |       record = <LogRecord: btc_agents, 20,                              | |
E             | |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
E             | |                52, "EVENT: SYSTEM_STARTUP">                             | |
E             | |         self = <Logger btc_agents (INFO)>                               | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1762 in callHandlers      |
E             |                                                                             |
E             |   1759             for hdlr in c.handlers:                                  |
E             |   1760                 found = found + 1                                    |
E             |   1761                 if record.levelno >= hdlr.level:                     |
E             | > 1762                     hdlr.handle(record)                              |
E             |   1763             if not c.propagate:                                      |
E             |   1764                 c = None    #break out                               |
E             |   1765             else:                                                    |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |      c = <Logger btc_agents (INFO)>                                     | |
E             | |  found = 3                                                              | |
E             | |   hdlr = <EventPanelHandler (INFO)>                                     | |
E             | | record = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |   self = <Logger btc_agents (INFO)>                                     | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\logging\__init__.py:1028 in handle            |
E             |                                                                             |
E             |   1025         if rv:                                                       |
E             |   1026             self.acquire()                                           |
E             |   1027             try:                                                     |
E             | > 1028                 self.emit(record)                                    |
E             |   1029             finally:                                                 |
E             |   1030                 self.release()                                       |
E             |   1031         return rv                                                    |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | record = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |     rv = <LogRecord: btc_agents, 20,                                    | |
E             | |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
E             | |          52, "EVENT: SYSTEM_STARTUP">                                   | |
E             | |   self = <EventPanelHandler (INFO)>                                     | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
E             | 07 in emit                                                                  |
E             |                                                                             |
E             |   204                 )                                                     |
E             |   205         except Exception as e:                                        |
E             |   206             # Fallback for panel errors                               |
E             | > 207             self.console.print(                                       |
E             |   208                 f"[dim](Panel Format Error: {e})[/dim] {record.getMes |
E             |   209             )                                                         |
E             |   210                                                                       |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | event_name = 'SYSTEM_STARTUP'                                           | |
E             | |       meta = {                                                          | |
E             | |                  'event': 'SYSTEM_STARTUP',                             | |
E             | |                  'mode': 'backtest',                                    | |
E             | |                  'config': {                                            | |
E             | |                      'symbol': 'BTCUSDT',                               | |
E             | |                      'interval': '1m',                                  | |
E             | |                      'source': 'mock',                                  | |
E             | |                      'duration': 10,                                    | |
E             | |                      'execution_mode': 'paper',                         | |
E             | |                      'fees_bps': 2.0,                                   | |
E             | |                      'slip_bps': 0.5,                                   | |
E             | |                      'dry_run': False,                                  | |
E             | |                      'kill_switch': False                               | |
E             | |                  },                                                     | |
E             | |                  'event_id': '***',                                     | |
E             | |                  'timestamp': '2026-01-25T01:26:00.136253Z'             | |
E             | |              }                                                          | |
E             | |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]backtest  | |
E             | |              [dim]config=[/dim]{'sym"+169                               | |
E             | |     record = <LogRecord: btc_agents, 20,                                | |
E             | |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
E             | |              52, "EVENT: SYSTEM_STARTUP">                               | |
E             | |       self = <EventPanelHandler (INFO)>                                 | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:1678 in print                                                            |
E             |                                                                             |
E             |   1675                 overflow = "ignore"                                  |
E             |   1676             crop = False                                             |
E             |   1677         render_hooks = self._render_hooks[:]                         |
E             | > 1678         with self:                                                   |
E             |   1679             renderables = self._collect_renderables(                 |
E             |   1680                 objects,                                             |
E             |   1681                 sep,                                                 |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer_extend = <built-in method extend of list object at              | |
E             | |                  0x000001C2C60AC300>                                    | |
E             | |           crop = True                                                   | |
E             | |          emoji = None                                                   | |
E             | |            end = '\n'                                                   | |
E             | |         extend = <built-in method extend of list object at              | |
E             | |                  0x000001C2C7C48E00>                                    | |
E             | |         height = None                                                   | |
E             | |      highlight = None                                                   | |
E             | |        justify = None                                                   | |
E             | |           line = [                                                      | |
E             | |                      Segment('position ', Style(dim=True)),             | |
E             | |                      Segment(                                           | |
E             | |                          '0',                                           | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': character maps to ', Style(dim=True)),  | |
E             | |                      Segment('<', Style(bold=True, dim=True)),          | |
E             | |                      Segment(                                           | |
E             | |                          'undefined',                                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'bright_magenta',                      | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=13                              | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True                                   | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment('>', Style(bold=True, dim=True)),          | |
E             | |                      Segment(')', Style(bold=True, dim=True)),          | |
E             | |                      Segment(' EVENT: SYSTEM_STARTUP', Style()),        | |
E             | |                      Segment('\n')                                      | |
E             | |                  ]                                                      | |
E             | |         markup = None                                                   | |
E             | | new_line_start = False                                                  | |
E             | |   new_segments = [                                                      | |
E             | |                      Segment('(', Style(bold=True, dim=True)),          | |
E             | |                      Segment('Panel Format Error: ', Style(dim=True)),  | |
E             | |                      Segment(                                           | |
E             | |                          "'charmap'",                                   | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(                                           | |
E             | |                          " codec can't encode character ",              | |
E             | |                          Style(dim=True)                                | |
E             | |                      ),                                                 | |
E             | |                      Segment(                                           | |
E             | |                          "'\\U0001f539'",                               | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'green',                               | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=2                               | |
E             | |                              ),                                         | |
E             | |                              bold=False,                                | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(' in ', Style(dim=True)),                  | |
E             | |                      Segment('\n', Style()),                            | |
E             | |                      Segment('position ', Style(dim=True)),             | |
E             | |                      Segment(                                           | |
E             | |                          '0',                                           | |
E             | |                          Style(                                         | |
E             | |                              color=Color(                               | |
E             | |                                  'cyan',                                | |
E             | |                                  ColorType.STANDARD,                    | |
E             | |                                  number=6                               | |
E             | |                              ),                                         | |
E             | |                              bold=True,                                 | |
E             | |                              dim=True,                                  | |
E             | |                              italic=False                               | |
E             | |                          )                                              | |
E             | |                      ),                                                 | |
E             | |                      Segment(': character maps to ', Style(dim=True)),  | |
E             | |                      ... +6                                             | |
E             | |                  ]                                                      | |
E             | |        no_wrap = None                                                   | |
E             | |        objects = (                                                      | |
E             | |                      "[dim](Panel Format Error: 'charmap' codec can't   | |
E             | |                  encode character '\\U0001f539' in"+71,                 | |
E             | |                  )                                                      | |
E             | |       overflow = None                                                   | |
E             | |         render = <bound method Console.render of <console width=79      | |
E             | |                  None>>                                                 | |
E             | |   render_hooks = []                                                     | |
E             | | render_options = ConsoleOptions(                                        | |
E             | |                      size=ConsoleDimensions(width=79, height=25),       | |
E             | |                      legacy_windows=True,                               | |
E             | |                      min_width=1,                                       | |
E             | |                      max_width=79,                                      | |
E             | |                      is_terminal=False,                                 | |
E             | |                      encoding='cp1252',                                 | |
E             | |                      max_height=25,                                     | |
E             | |                      justify=None,                                      | |
E             | |                      overflow=None,                                     | |
E             | |                      no_wrap=None,                                      | |
E             | |                      highlight=None,                                    | |
E             | |                      markup=None,                                       | |
E             | |                      height=None                                        | |
E             | |                  )                                                      | |
E             | |     renderable = <text "(Panel Format Error: 'charmap' codec can't      | |
E             | |                  encode character '\\U0001f539' in position 0:          | |
E             | |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
E             | |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
E             | |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
E             | |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
E             | |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
E             | |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
E             | |                  'dim')] ''>                                            | |
E             | |    renderables = [                                                      | |
E             | |                      <text "(Panel Format Error: 'charmap' codec can't  | |
E             | |                  encode character '\\U0001f539' in position 0:          | |
E             | |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
E             | |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
E             | |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
E             | |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
E             | |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
E             | |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
E             | |                  'dim')] ''>                                            | |
E             | |                  ]                                                      | |
E             | |           self = <console width=79 None>                                | |
E             | |            sep = ' '                                                    | |
E             | |      soft_wrap = False                                                  | |
E             | |          style = None                                                   | |
E             | |          width = None                                                   | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:864 in __exit__                                                          |
E             |                                                                             |
E             |    861                                                                      |
E             |    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
E             |    863         """Exit buffer context."""                                   |
E             | >  864         self._exit_buffer()                                          |
E             |    865                                                                      |
E             |    866     def begin_capture(self) -> None:                                 |
E             |    867         """Begin capturing console output. Call :meth:`end_capture`  |
E             |                                                                             |
E             | +-------------- locals ---------------+                                     |
E             | |  exc_type = None                    |                                     |
E             | | exc_value = None                    |                                     |
E             | |      self = <console width=79 None> |                                     |
E             | | traceback = None                    |                                     |
E             | +-------------------------------------+                                     |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:822 in _exit_buffer                                                      |
E             |                                                                             |
E             |    819     def _exit_buffer(self) -> None:                                  |
E             |    820         """Leave buffer context, and render content if required."""  |
E             |    821         self._buffer_index -= 1                                      |
E             | >  822         self._check_buffer()                                         |
E             |    823                                                                      |
E             |    824     def set_live(self, live: "Live") -> None:                        |
E             |    825         """Set Live instance. Used by Live context manager.          |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2019 in _check_buffer                                                    |
E             |                                                                             |
E             |   2016             return                                                   |
E             |   2017                                                                      |
E             |   2018         try:                                                         |
E             | > 2019             self._write_buffer()                                     |
E             |   2020         except BrokenPipeError:                                      |
E             |   2021             self.on_broken_pipe()                                    |
E             |   2022                                                                      |
E             |                                                                             |
E             | +------------ locals ------------+                                          |
E             | | self = <console width=79 None> |                                          |
E             | +--------------------------------+                                          |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
E             | py:2055 in _write_buffer                                                    |
E             |                                                                             |
E             |   2052                             if self.no_color and self._color_system: |
E             |   2053                                 buffer = list(Segment.remove_color(b |
E             |   2054                                                                      |
E             | > 2055                             legacy_windows_render(buffer, LegacyWind |
E             |   2056                         else:                                        |
E             |   2057                             # Either a non-std stream on legacy Wind |
E             |   2058                             text = self._render_buffer(self._buffer[ |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |                    buffer = [                                           | |
E             | |                                 Segment('\U0001f539 ', Style()),                | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP           ',        | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'cyan',                     | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=6                    | |
E             | |                                         ),                              | |
E             | |                                         bold=True                       | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'event',                            | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'SYSTEM_STARTUP',                   | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment(' ', Style()),                  | |
E             | |                                 Segment(                                | |
E             | |                                     'mode',                             | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'yellow',                   | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=3                    | |
E             | |                                         ),                              | |
E             | |                                         dim=True,                       | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 Segment('=', Style(dim=True)),          | |
E             | |                                 Segment(                                | |
E             | |                                     'backtest',                         | |
E             | |                                     Style(                              | |
E             | |                                         color=Color(                    | |
E             | |                                             'magenta',                  | |
E             | |                                             ColorType.STANDARD,         | |
E             | |                                             number=5                    | |
E             | |                                         ),                              | |
E             | |                                         italic=False                    | |
E             | |                                     )                                   | |
E             | |                                 ),                                      | |
E             | |                                 ... +60                                 | |
E             | |                             ]                                           | |
E             | |                    fileno = 1                                           | |
E             | |                      self = <console width=79 None>                     | |
E             | | use_legacy_windows_render = True                                        | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
E             | _renderer.py:19 in legacy_windows_render                                    |
E             |                                                                             |
E             |   16             if style:                                                  |
E             |   17                 term.write_styled(text, style)                         |
E             |   18             else:                                                      |
E             | > 19                 term.write_text(text)                                  |
E             |   20         else:                                                          |
E             |   21             control_codes: Sequence[ControlCode] = control             |
E             |   22             for control_code in control_codes:                         |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | |  buffer = [                                                             | |
E             | |               Segment('\U0001f539 ', Style()),                                  | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP           ',                          | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'cyan',                                       | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=6                                      | |
E             | |                       ),                                                | |
E             | |                       bold=True                                         | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'event',                                              | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'SYSTEM_STARTUP',                                     | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment(' ', Style()),                                    | |
E             | |               Segment(                                                  | |
E             | |                   'mode',                                               | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'yellow',                                     | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=3                                      | |
E             | |                       ),                                                | |
E             | |                       dim=True,                                         | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               Segment('=', Style(dim=True)),                            | |
E             | |               Segment(                                                  | |
E             | |                   'backtest',                                           | |
E             | |                   Style(                                                | |
E             | |                       color=Color(                                      | |
E             | |                           'magenta',                                    | |
E             | |                           ColorType.STANDARD,                           | |
E             | |                           number=5                                      | |
E             | |                       ),                                                | |
E             | |                       italic=False                                      | |
E             | |                   )                                                     | |
E             | |               ),                                                        | |
E             | |               ... +60                                                   | |
E             | |           ]                                                             | |
E             | | control = None                                                          | |
E             | |   style = Style()                                                       | |
E             | |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
E             | |           0x000001C2C7BF89B0>                                           | |
E             | |    text = '\U0001f539 '                                                         | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
E             | onsole.py:402 in write_text                                                 |
E             |                                                                             |
E             |   399         Args:                                                         |
E             |   400             text (str): The text to write to the console              |
E             |   401         """                                                           |
E             | > 402         self.write(text)                                              |
E             |   403         self.flush()                                                  |
E             |   404                                                                       |
E             |   405     def write_styled(self, text: str, style: Style) -> None:          |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
E             | |        0x000001C2C7BF89B0>                                              | |
E             | | text = '\U0001f539 '                                                            | |
E             | +-------------------------------------------------------------------------+ |
E             |                                                                             |
E             | C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
E             |                                                                             |
E             |    16                                                                       |
E             |    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
E             |    18     def encode(self, input, final=False):                             |
E             | >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
E             |    20                                                                       |
E             |    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
E             |    22     def decode(self, input, final=False):                             |
E             |                                                                             |
E             | +-------------------------------- locals ---------------------------------+ |
E             | | final = False                                                           | |
E             | | input = '\U0001f539 '                                                           | |
E             | |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
E             | |         0x000001C2C295BEC0>                                             | |
E             | +-------------------------------------------------------------------------+ |
E             +-----------------------------------------------------------------------------+
E             UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
E             position 0: character maps to <undefined>
E             
E           assert 1 == 0
E            +  where 1 = CompletedProcess(args=['C:\\ProgramData\\miniconda3\\python.exe', '-m', 'laptop_agents', 'run', '--mode', 'backtest', ...codeError: \'charmap\' codec can\'t encode character \'\\U0001f539\' in \nposition 0: character maps to <undefined>\n').returncode

tests\test_run_reproducibility.py:62: AssertionError
---------------------------- Captured stdout call -----------------------------
2. Testing --mode backtest artifacts...
[FAIL] Backtest returned non-zero exit code.
STDERR: +--------------------- Traceback (most recent call last) ---------------------+
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
| 02 in emit                                                                  |
|                                                                             |
|   199                         if k not in ["timestamp", "event_id"]         |
|   200                     ]                                                 |
|   201                 )                                                     |
| > 202                 self.console.print(                                   |
|   203                     f"\U0001f539 [bold cyan]{event_name: <25}[/bold cyan] {me |
|   204                 )                                                     |
|   205         except Exception as e:                                        |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | event_name = 'SYSTEM_STARTUP'                                           | |
| |       meta = {                                                          | |
| |                  'event': 'SYSTEM_STARTUP',                             | |
| |                  'mode': 'backtest',                                    | |
| |                  'config': {                                            | |
| |                      'symbol': 'BTCUSDT',                               | |
| |                      'interval': '1m',                                  | |
| |                      'source': 'mock',                                  | |
| |                      'duration': 10,                                    | |
| |                      'execution_mode': 'paper',                         | |
| |                      'fees_bps': 2.0,                                   | |
| |                      'slip_bps': 0.5,                                   | |
| |                      'dry_run': False,                                  | |
| |                      'kill_switch': False                               | |
| |                  },                                                     | |
| |                  'event_id': '***',                                     | |
| |                  'timestamp': '2026-01-25T01:26:00.136253Z'             | |
| |              }                                                          | |
| |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]backtest  | |
| |              [dim]config=[/dim]{'sym"+169                               | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <EventPanelHandler (INFO)>                                 | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:1678 in print                                                            |
|                                                                             |
|   1675                 overflow = "ignore"                                  |
|   1676             crop = False                                             |
|   1677         render_hooks = self._render_hooks[:]                         |
| > 1678         with self:                                                   |
|   1679             renderables = self._collect_renderables(                 |
|   1680                 objects,                                             |
|   1681                 sep,                                                 |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer_extend = <built-in method extend of list object at              | |
| |                  0x000001C2C60AC300>                                    | |
| |           crop = True                                                   | |
| |          emoji = None                                                   | |
| |            end = '\n'                                                   | |
| |         extend = <built-in method extend of list object at              | |
| |                  0x000001C2C7C49880>                                    | |
| |         height = None                                                   | |
| |      highlight = None                                                   | |
| |        justify = None                                                   | |
| |           line = [                                                      | |
| |                      Segment(                                           | |
| |                          'False',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_red',                          | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=9                               | |
| |                              ),                                         | |
| |                              italic=True                                | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(', ', Style()),                            | |
| |                      Segment(                                           | |
| |                          "'kill_switch'",                               | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': ', Style()),                            | |
| |                      Segment(                                           | |
| |                          'False',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_red',                          | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=9                               | |
| |                              ),                                         | |
| |                              italic=True                                | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('}', Style(bold=True)),                    | |
| |                      Segment('\n')                                      | |
| |                  ]                                                      | |
| |         markup = None                                                   | |
| | new_line_start = False                                                  | |
| |   new_segments = [                                                      | |
| |                      Segment('\U0001f539 ', Style()),                           | |
| |                      Segment(                                           | |
| |                          'SYSTEM_STARTUP           ',                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True                                  | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' ', Style()),                             | |
| |                      Segment(                                           | |
| |                          'event',                                       | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'yellow',                              | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=3                               | |
| |                              ),                                         | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('=', Style(dim=True)),                     | |
| |                      Segment(                                           | |
| |                          'SYSTEM_STARTUP',                              | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'magenta',                             | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=5                               | |
| |                              ),                                         | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' ', Style()),                             | |
| |                      Segment(                                           | |
| |                          'mode',                                        | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'yellow',                              | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=3                               | |
| |                              ),                                         | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('=', Style(dim=True)),                     | |
| |                      Segment(                                           | |
| |                          'backtest',                                    | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'magenta',                             | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=5                               | |
| |                              ),                                         | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      ... +41                                            | |
| |                  ]                                                      | |
| |        no_wrap = None                                                   | |
| |        objects = (                                                      | |
| |                      '\U0001f539 [bold cyan]SYSTEM_STARTUP           [/bold     | |
| |                  cyan] [dim]event=[/dim]SYSTEM_START'+220,              | |
| |                  )                                                      | |
| |       overflow = None                                                   | |
| |         render = <bound method Console.render of <console width=79      | |
| |                  None>>                                                 | |
| |   render_hooks = []                                                     | |
| | render_options = ConsoleOptions(                                        | |
| |                      size=ConsoleDimensions(width=79, height=25),       | |
| |                      legacy_windows=True,                               | |
| |                      min_width=1,                                       | |
| |                      max_width=79,                                      | |
| |                      is_terminal=False,                                 | |
| |                      encoding='cp1252',                                 | |
| |                      max_height=25,                                     | |
| |                      justify=None,                                      | |
| |                      overflow=None,                                     | |
| |                      no_wrap=None,                                      | |
| |                      highlight=None,                                    | |
| |                      markup=None,                                       | |
| |                      height=None                                        | |
| |                  )                                                      | |
| |     renderable = <text "\U0001f539 SYSTEM_STARTUP                               | |
| |                  event=SYSTEM_STARTUP mode=backtest config={'symbol':   | |
| |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
| |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
| |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
| |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
| |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
| |                  'repr.attrib_name'), Span(54, 62,                      | |
| |                  'repr.attrib_value'), Span(63, 69,                     | |
| |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
| |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
| |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
| |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
| |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
| |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
| |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
| |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
| |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
| |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
| |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
| |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
| |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
| |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
| |                  ''>                                                    | |
| |    renderables = [                                                      | |
| |                      <text "\U0001f539 SYSTEM_STARTUP                           | |
| |                  event=SYSTEM_STARTUP mode=backtest config={'symbol':   | |
| |                  'BTCUSDT', 'interval': '1m', 'source': 'mock',         | |
| |                  'duration': 10, 'execution_mode': 'paper', 'fees_bps': | |
| |                  2.0, 'slip_bps': 0.5, 'dry_run': False, 'kill_switch': | |
| |                  False}" [Span(28, 33, 'repr.attrib_name'), Span(34,    | |
| |                  48, 'repr.attrib_value'), Span(49, 53,                 | |
| |                  'repr.attrib_name'), Span(54, 62,                      | |
| |                  'repr.attrib_value'), Span(63, 69,                     | |
| |                  'repr.attrib_name'), Span(70, 71, 'repr.brace'),       | |
| |                  Span(243, 244, 'repr.brace'), Span(71, 79,             | |
| |                  'repr.str'), Span(81, 90, 'repr.str'), Span(92, 102,   | |
| |                  'repr.str'), Span(104, 108, 'repr.str'), Span(110,     | |
| |                  118, 'repr.str'), Span(120, 126, 'repr.str'),          | |
| |                  Span(128, 138, 'repr.str'), Span(140, 142,             | |
| |                  'repr.number'), Span(144, 160, 'repr.str'), Span(162,  | |
| |                  169, 'repr.str'), Span(171, 181, 'repr.str'),          | |
| |                  Span(183, 186, 'repr.number'), Span(188, 198,          | |
| |                  'repr.str'), Span(200, 203, 'repr.number'), Span(205,  | |
| |                  214, 'repr.str'), Span(216, 221, 'repr.bool_false'),   | |
| |                  Span(223, 236, 'repr.str'), Span(238, 243,             | |
| |                  'repr.bool_false'), Span(2, 27, 'bold cyan'), Span(28, | |
| |                  34, 'dim'), Span(49, 54, 'dim'), Span(63, 70, 'dim')]  | |
| |                  ''>                                                    | |
| |                  ]                                                      | |
| |           self = <console width=79 None>                                | |
| |            sep = ' '                                                    | |
| |      soft_wrap = False                                                  | |
| |          style = None                                                   | |
| |          width = None                                                   | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:864 in __exit__                                                          |
|                                                                             |
|    861                                                                      |
|    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
|    863         """Exit buffer context."""                                   |
| >  864         self._exit_buffer()                                          |
|    865                                                                      |
|    866     def begin_capture(self) -> None:                                 |
|    867         """Begin capturing console output. Call :meth:`end_capture`  |
|                                                                             |
| +-------------- locals ---------------+                                     |
| |  exc_type = None                    |                                     |
| | exc_value = None                    |                                     |
| |      self = <console width=79 None> |                                     |
| | traceback = None                    |                                     |
| +-------------------------------------+                                     |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:822 in _exit_buffer                                                      |
|                                                                             |
|    819     def _exit_buffer(self) -> None:                                  |
|    820         """Leave buffer context, and render content if required."""  |
|    821         self._buffer_index -= 1                                      |
| >  822         self._check_buffer()                                         |
|    823                                                                      |
|    824     def set_live(self, live: "Live") -> None:                        |
|    825         """Set Live instance. Used by Live context manager.          |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2019 in _check_buffer                                                    |
|                                                                             |
|   2016             return                                                   |
|   2017                                                                      |
|   2018         try:                                                         |
| > 2019             self._write_buffer()                                     |
|   2020         except BrokenPipeError:                                      |
|   2021             self.on_broken_pipe()                                    |
|   2022                                                                      |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2055 in _write_buffer                                                    |
|                                                                             |
|   2052                             if self.no_color and self._color_system: |
|   2053                                 buffer = list(Segment.remove_color(b |
|   2054                                                                      |
| > 2055                             legacy_windows_render(buffer, LegacyWind |
|   2056                         else:                                        |
|   2057                             # Either a non-std stream on legacy Wind |
|   2058                             text = self._render_buffer(self._buffer[ |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    buffer = [                                           | |
| |                                 Segment('\U0001f539 ', Style()),                | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP           ',        | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'cyan',                     | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=6                    | |
| |                                         ),                              | |
| |                                         bold=True                       | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'event',                            | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP',                   | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'mode',                             | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'backtest',                         | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 ... +44                                 | |
| |                             ]                                           | |
| |                    fileno = 1                                           | |
| |                      self = <console width=79 None>                     | |
| | use_legacy_windows_render = True                                        | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
| _renderer.py:19 in legacy_windows_render                                    |
|                                                                             |
|   16             if style:                                                  |
|   17                 term.write_styled(text, style)                         |
|   18             else:                                                      |
| > 19                 term.write_text(text)                                  |
|   20         else:                                                          |
|   21             control_codes: Sequence[ControlCode] = control             |
|   22             for control_code in control_codes:                         |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer = [                                                             | |
| |               Segment('\U0001f539 ', Style()),                                  | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP           ',                          | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'cyan',                                       | |
| |                           ColorType.STANDARD,                           | |
| |                           number=6                                      | |
| |                       ),                                                | |
| |                       bold=True                                         | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'event',                                              | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP',                                     | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'mode',                                               | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'backtest',                                           | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               ... +44                                                   | |
| |           ]                                                             | |
| | control = None                                                          | |
| |   style = Style()                                                       | |
| |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
| |           0x000001C2C755EE70>                                           | |
| |    text = '\U0001f539 '                                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
| onsole.py:402 in write_text                                                 |
|                                                                             |
|   399         Args:                                                         |
|   400             text (str): The text to write to the console              |
|   401         """                                                           |
| > 402         self.write(text)                                              |
|   403         self.flush()                                                  |
|   404                                                                       |
|   405     def write_styled(self, text: str, style: Style) -> None:          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
| |        0x000001C2C755EE70>                                              | |
| | text = '\U0001f539 '                                                            | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
|                                                                             |
|    16                                                                       |
|    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
|    18     def encode(self, input, final=False):                             |
| >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
|    20                                                                       |
|    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
|    22     def decode(self, input, final=False):                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | final = False                                                           | |
| | input = '\U0001f539 '                                                           | |
| |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
| |         0x000001C2C295BEC0>                                             | |
| +-------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------+
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
position 0: character maps to <undefined>

During handling of the above exception, another exception occurred:

+--------------------- Traceback (most recent call last) ---------------------+
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\commands\session |
| .py:207 in run                                                              |
|                                                                             |
|   204                                                                       |
|   205     mode = args.mode or ("backtest" if args.backtest > 0 else "single |
|   206                                                                       |
| > 207     append_event(                                                     |
|   208         {                                                             |
|   209             "event": "SYSTEM_STARTUP",                                |
|   210             "mode": mode,                                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    args = namespace(source='mock', symbol='BTCUSDT',    | |
| |                           interval='1m', limit=200, fees_bps=2.0,       | |
| |                           slip_bps=0.5, backtest=100,                   | |
| |                           backtest_mode='position', mode='backtest',    | |
| |                           duration=10, once=False,                      | |
| |                           execution_mode='paper', risk_pct=1.0,         | |
| |                           stop_bps=30.0, tp_r=1.5, max_leverage=1.0,    | |
| |                           intrabar_mode='conservative',                 | |
| |                           validate_splits=5, validate_train=600,        | |
| |                           validate_test=200,                            | |
| |                           grid='sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0à | |
| |                           validate_max_candidates=200, dry_run=False,   | |
| |                           show=False, strategy='default',               | |
| |                           async_mode=True, stale_timeout=120,           | |
| |                           execution_latency_ms=200, dashboard=False,    | |
| |                           preflight=False, replay=None, config=None,    | |
| |                           quiet=False, verbose=False)                   | |
| |              async_mode = True                                          | |
| |                  atexit = <module 'atexit' (built-in)>                  | |
| |                backtest = 100                                           | |
| |           backtest_mode = 'position'                                    | |
| |                  config = None                                          | |
| |               dashboard = False                                         | |
| |                 dry_run = False                                         | |
| |                duration = 10                                            | |
| |    execution_latency_ms = 200                                           | |
| |          execution_mode = 'paper'                                       | |
| |                fees_bps = 2.0                                           | |
| |                    grid = 'sma=10,30;stop=20,30,40;tp=1.0,1.5,2.0'      | |
| |                interval = '1m'                                          | |
| |           intrabar_mode = 'conservative'                                | |
| |                   limit = 200                                           | |
| |                    lock = <laptop_agents.core.lock_manager.LockManager  | |
| |                           object at 0x000001C2C7C2FFE0>                 | |
| |            max_leverage = 1.0                                           | |
| |                    mode = 'backtest'                                    | |
| |                    once = False                                         | |
| |               preflight = False                                         | |
| |                   quiet = False                                         | |
| |                  replay = None                                          | |
| |                risk_pct = 1.0                                           | |
| |          session_config = SessionConfig(                                | |
| |                               symbol='BTCUSDT',                         | |
| |                               interval='1m',                            | |
| |                               source='mock',                            | |
| |                               duration=10,                              | |
| |                               execution_mode='paper',                   | |
| |                               fees_bps=2.0,                             | |
| |                               slip_bps=0.5,                             | |
| |                               dry_run=False,                            | |
| |                               kill_switch=False                         | |
| |                           )                                             | |
| |                    show = False                                         | |
| |                slip_bps = 0.5                                           | |
| |                  source = 'mock'                                        | |
| |           stale_timeout = 120                                           | |
| |                stop_bps = 30.0                                          | |
| |                strategy = 'default'                                     | |
| |                  symbol = 'BTCUSDT'                                     | |
| |                    tp_r = 1.5                                           | |
| | validate_max_candidates = 200                                           | |
| |         validate_splits = 5                                             | |
| |           validate_test = 200                                           | |
| |          validate_train = 600                                           | |
| |                 verbose = False                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\events.py:5 |
| 2 in append_event                                                           |
|                                                                             |
|   49                                                                        |
|   50     obj.setdefault("timestamp", utc_ts())                              |
|   51     event_name = obj.get("event", "UnnamedEvent")                      |
| > 52     logger.info(f"EVENT: {event_name}", obj)                           |
|   53                                                                        |
|   54     if paper:                                                          |
|   55         PAPER_DIR.mkdir(parents=True, exist_ok=True)  # Ensure parents |
|                                                                             |
| +----------------------------- locals -----------------------------+        |
| |    content = {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'backtest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  }                                               |        |
| |              }                                                   |        |
| |   event_id = '3992cb3cb53b443218ec8808fb730640'                  |        |
| | event_name = 'SYSTEM_STARTUP'                                    |        |
| |        obj = {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'backtest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  },                                              |        |
| |                  'event_id': '3992cb3cb53b443218ec8808fb730640', |        |
| |                  'timestamp': '2026-01-25T01:26:00.136253Z'      |        |
| |              }                                                   |        |
| |      paper = True                                                |        |
| +------------------------------------------------------------------+        |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1539 in info              |
|                                                                             |
|   1536         logger.info("Houston, we have a %s", "notable problem", exc_ |
|   1537         """                                                          |
|   1538         if self.isEnabledFor(INFO):                                  |
| > 1539             self._log(INFO, msg, args, **kwargs)                     |
|   1540                                                                      |
|   1541     def warning(self, msg, *args, **kwargs):                         |
|   1542         """                                                          |
|                                                                             |
| +----------------------------- locals -----------------------------+        |
| |   args = (                                                       |        |
| |              {                                                   |        |
| |                  'event': 'SYSTEM_STARTUP',                      |        |
| |                  'mode': 'backtest',                             |        |
| |                  'config': {                                     |        |
| |                      'symbol': 'BTCUSDT',                        |        |
| |                      'interval': '1m',                           |        |
| |                      'source': 'mock',                           |        |
| |                      'duration': 10,                             |        |
| |                      'execution_mode': 'paper',                  |        |
| |                      'fees_bps': 2.0,                            |        |
| |                      'slip_bps': 0.5,                            |        |
| |                      'dry_run': False,                           |        |
| |                      'kill_switch': False                        |        |
| |                  },                                              |        |
| |                  'event_id': '3992cb3cb53b443218ec8808fb730640', |        |
| |                  'timestamp': '2026-01-25T01:26:00.136253Z'      |        |
| |              },                                                  |        |
| |          )                                                       |        |
| | kwargs = {}                                                      |        |
| |    msg = 'EVENT: SYSTEM_STARTUP'                                 |        |
| |   self = <Logger btc_agents (INFO)>                              |        |
| +------------------------------------------------------------------+        |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1684 in _log              |
|                                                                             |
|   1681                 exc_info = sys.exc_info()                            |
|   1682         record = self.makeRecord(self.name, level, fn, lno, msg, arg |
|   1683                                  exc_info, func, extra, sinfo)       |
| > 1684         self.handle(record)                                          |
|   1685                                                                      |
|   1686     def handle(self, record):                                        |
|   1687         """                                                          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |       args = (                                                          | |
| |                  {                                                      | |
| |                      'event': 'SYSTEM_STARTUP',                         | |
| |                      'mode': 'backtest',                                | |
| |                      'config': {                                        | |
| |                          'symbol': 'BTCUSDT',                           | |
| |                          'interval': '1m',                              | |
| |                          'source': 'mock',                              | |
| |                          'duration': 10,                                | |
| |                          'execution_mode': 'paper',                     | |
| |                          'fees_bps': 2.0,                               | |
| |                          'slip_bps': 0.5,                               | |
| |                          'dry_run': False,                              | |
| |                          'kill_switch': False                           | |
| |                      },                                                 | |
| |                      'event_id': '3992cb3cb53b443218ec8808fb730640',    | |
| |                      'timestamp': '2026-01-25T01:26:00.136253Z'         | |
| |                  },                                                     | |
| |              )                                                          | |
| |   exc_info = None                                                       | |
| |      extra = None                                                       | |
| |         fn = 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\src\\laptoà | |
| |       func = 'append_event'                                             | |
| |      level = 20                                                         | |
| |        lno = 52                                                         | |
| |        msg = 'EVENT: SYSTEM_STARTUP'                                    | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <Logger btc_agents (INFO)>                                 | |
| |      sinfo = None                                                       | |
| | stack_info = False                                                      | |
| | stacklevel = 1                                                          | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1700 in handle            |
|                                                                             |
|   1697             return                                                   |
|   1698         if isinstance(maybe_record, LogRecord):                      |
|   1699             record = maybe_record                                    |
| > 1700         self.callHandlers(record)                                    |
|   1701                                                                      |
|   1702     def addHandler(self, hdlr):                                      |
|   1703         """                                                          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | maybe_record = <LogRecord: btc_agents, 20,                              | |
| |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
| |                52, "EVENT: SYSTEM_STARTUP">                             | |
| |       record = <LogRecord: btc_agents, 20,                              | |
| |                C:\Users\lovel\trading\btc-laptop-agents\src\laptop_ageà | |
| |                52, "EVENT: SYSTEM_STARTUP">                             | |
| |         self = <Logger btc_agents (INFO)>                               | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1762 in callHandlers      |
|                                                                             |
|   1759             for hdlr in c.handlers:                                  |
|   1760                 found = found + 1                                    |
|   1761                 if record.levelno >= hdlr.level:                     |
| > 1762                     hdlr.handle(record)                              |
|   1763             if not c.propagate:                                      |
|   1764                 c = None    #break out                               |
|   1765             else:                                                    |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |      c = <Logger btc_agents (INFO)>                                     | |
| |  found = 3                                                              | |
| |   hdlr = <EventPanelHandler (INFO)>                                     | |
| | record = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |   self = <Logger btc_agents (INFO)>                                     | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\logging\__init__.py:1028 in handle            |
|                                                                             |
|   1025         if rv:                                                       |
|   1026             self.acquire()                                           |
|   1027             try:                                                     |
| > 1028                 self.emit(record)                                    |
|   1029             finally:                                                 |
|   1030                 self.release()                                       |
|   1031         return rv                                                    |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | record = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |     rv = <LogRecord: btc_agents, 20,                                    | |
| |          C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\coà | |
| |          52, "EVENT: SYSTEM_STARTUP">                                   | |
| |   self = <EventPanelHandler (INFO)>                                     | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agents\core\logger.py:2 |
| 07 in emit                                                                  |
|                                                                             |
|   204                 )                                                     |
|   205         except Exception as e:                                        |
|   206             # Fallback for panel errors                               |
| > 207             self.console.print(                                       |
|   208                 f"[dim](Panel Format Error: {e})[/dim] {record.getMes |
|   209             )                                                         |
|   210                                                                       |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | event_name = 'SYSTEM_STARTUP'                                           | |
| |       meta = {                                                          | |
| |                  'event': 'SYSTEM_STARTUP',                             | |
| |                  'mode': 'backtest',                                    | |
| |                  'config': {                                            | |
| |                      'symbol': 'BTCUSDT',                               | |
| |                      'interval': '1m',                                  | |
| |                      'source': 'mock',                                  | |
| |                      'duration': 10,                                    | |
| |                      'execution_mode': 'paper',                         | |
| |                      'fees_bps': 2.0,                                   | |
| |                      'slip_bps': 0.5,                                   | |
| |                      'dry_run': False,                                  | |
| |                      'kill_switch': False                               | |
| |                  },                                                     | |
| |                  'event_id': '***',                                     | |
| |                  'timestamp': '2026-01-25T01:26:00.136253Z'             | |
| |              }                                                          | |
| |   meta_str = "[dim]event=[/dim]SYSTEM_STARTUP [dim]mode=[/dim]backtest  | |
| |              [dim]config=[/dim]{'sym"+169                               | |
| |     record = <LogRecord: btc_agents, 20,                                | |
| |              C:\Users\lovel\trading\btc-laptop-agents\src\laptop_agentà | |
| |              52, "EVENT: SYSTEM_STARTUP">                               | |
| |       self = <EventPanelHandler (INFO)>                                 | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:1678 in print                                                            |
|                                                                             |
|   1675                 overflow = "ignore"                                  |
|   1676             crop = False                                             |
|   1677         render_hooks = self._render_hooks[:]                         |
| > 1678         with self:                                                   |
|   1679             renderables = self._collect_renderables(                 |
|   1680                 objects,                                             |
|   1681                 sep,                                                 |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer_extend = <built-in method extend of list object at              | |
| |                  0x000001C2C60AC300>                                    | |
| |           crop = True                                                   | |
| |          emoji = None                                                   | |
| |            end = '\n'                                                   | |
| |         extend = <built-in method extend of list object at              | |
| |                  0x000001C2C7C48E00>                                    | |
| |         height = None                                                   | |
| |      highlight = None                                                   | |
| |        justify = None                                                   | |
| |           line = [                                                      | |
| |                      Segment('position ', Style(dim=True)),             | |
| |                      Segment(                                           | |
| |                          '0',                                           | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': character maps to ', Style(dim=True)),  | |
| |                      Segment('<', Style(bold=True, dim=True)),          | |
| |                      Segment(                                           | |
| |                          'undefined',                                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'bright_magenta',                      | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=13                              | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True                                   | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment('>', Style(bold=True, dim=True)),          | |
| |                      Segment(')', Style(bold=True, dim=True)),          | |
| |                      Segment(' EVENT: SYSTEM_STARTUP', Style()),        | |
| |                      Segment('\n')                                      | |
| |                  ]                                                      | |
| |         markup = None                                                   | |
| | new_line_start = False                                                  | |
| |   new_segments = [                                                      | |
| |                      Segment('(', Style(bold=True, dim=True)),          | |
| |                      Segment('Panel Format Error: ', Style(dim=True)),  | |
| |                      Segment(                                           | |
| |                          "'charmap'",                                   | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(                                           | |
| |                          " codec can't encode character ",              | |
| |                          Style(dim=True)                                | |
| |                      ),                                                 | |
| |                      Segment(                                           | |
| |                          "'\\U0001f539'",                               | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'green',                               | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=2                               | |
| |                              ),                                         | |
| |                              bold=False,                                | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(' in ', Style(dim=True)),                  | |
| |                      Segment('\n', Style()),                            | |
| |                      Segment('position ', Style(dim=True)),             | |
| |                      Segment(                                           | |
| |                          '0',                                           | |
| |                          Style(                                         | |
| |                              color=Color(                               | |
| |                                  'cyan',                                | |
| |                                  ColorType.STANDARD,                    | |
| |                                  number=6                               | |
| |                              ),                                         | |
| |                              bold=True,                                 | |
| |                              dim=True,                                  | |
| |                              italic=False                               | |
| |                          )                                              | |
| |                      ),                                                 | |
| |                      Segment(': character maps to ', Style(dim=True)),  | |
| |                      ... +6                                             | |
| |                  ]                                                      | |
| |        no_wrap = None                                                   | |
| |        objects = (                                                      | |
| |                      "[dim](Panel Format Error: 'charmap' codec can't   | |
| |                  encode character '\\U0001f539' in"+71,                 | |
| |                  )                                                      | |
| |       overflow = None                                                   | |
| |         render = <bound method Console.render of <console width=79      | |
| |                  None>>                                                 | |
| |   render_hooks = []                                                     | |
| | render_options = ConsoleOptions(                                        | |
| |                      size=ConsoleDimensions(width=79, height=25),       | |
| |                      legacy_windows=True,                               | |
| |                      min_width=1,                                       | |
| |                      max_width=79,                                      | |
| |                      is_terminal=False,                                 | |
| |                      encoding='cp1252',                                 | |
| |                      max_height=25,                                     | |
| |                      justify=None,                                      | |
| |                      overflow=None,                                     | |
| |                      no_wrap=None,                                      | |
| |                      highlight=None,                                    | |
| |                      markup=None,                                       | |
| |                      height=None                                        | |
| |                  )                                                      | |
| |     renderable = <text "(Panel Format Error: 'charmap' codec can't      | |
| |                  encode character '\\U0001f539' in position 0:          | |
| |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
| |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
| |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
| |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
| |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
| |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
| |                  'dim')] ''>                                            | |
| |    renderables = [                                                      | |
| |                      <text "(Panel Format Error: 'charmap' codec can't  | |
| |                  encode character '\\U0001f539' in position 0:          | |
| |                  character maps to <undefined>) EVENT: SYSTEM_STARTUP"  | |
| |                  [Span(106, 107, 'repr.tag_start'), Span(107, 116,      | |
| |                  'repr.tag_name'), Span(116, 117, 'repr.tag_end'),      | |
| |                  Span(0, 1, 'repr.brace'), Span(117, 118,               | |
| |                  'repr.brace'), Span(21, 30, 'repr.str'), Span(60, 72,  | |
| |                  'repr.str'), Span(85, 86, 'repr.number'), Span(0, 118, | |
| |                  'dim')] ''>                                            | |
| |                  ]                                                      | |
| |           self = <console width=79 None>                                | |
| |            sep = ' '                                                    | |
| |      soft_wrap = False                                                  | |
| |          style = None                                                   | |
| |          width = None                                                   | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:864 in __exit__                                                          |
|                                                                             |
|    861                                                                      |
|    862     def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any |
|    863         """Exit buffer context."""                                   |
| >  864         self._exit_buffer()                                          |
|    865                                                                      |
|    866     def begin_capture(self) -> None:                                 |
|    867         """Begin capturing console output. Call :meth:`end_capture`  |
|                                                                             |
| +-------------- locals ---------------+                                     |
| |  exc_type = None                    |                                     |
| | exc_value = None                    |                                     |
| |      self = <console width=79 None> |                                     |
| | traceback = None                    |                                     |
| +-------------------------------------+                                     |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:822 in _exit_buffer                                                      |
|                                                                             |
|    819     def _exit_buffer(self) -> None:                                  |
|    820         """Leave buffer context, and render content if required."""  |
|    821         self._buffer_index -= 1                                      |
| >  822         self._check_buffer()                                         |
|    823                                                                      |
|    824     def set_live(self, live: "Live") -> None:                        |
|    825         """Set Live instance. Used by Live context manager.          |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2019 in _check_buffer                                                    |
|                                                                             |
|   2016             return                                                   |
|   2017                                                                      |
|   2018         try:                                                         |
| > 2019             self._write_buffer()                                     |
|   2020         except BrokenPipeError:                                      |
|   2021             self.on_broken_pipe()                                    |
|   2022                                                                      |
|                                                                             |
| +------------ locals ------------+                                          |
| | self = <console width=79 None> |                                          |
| +--------------------------------+                                          |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\console. |
| py:2055 in _write_buffer                                                    |
|                                                                             |
|   2052                             if self.no_color and self._color_system: |
|   2053                                 buffer = list(Segment.remove_color(b |
|   2054                                                                      |
| > 2055                             legacy_windows_render(buffer, LegacyWind |
|   2056                         else:                                        |
|   2057                             # Either a non-std stream on legacy Wind |
|   2058                             text = self._render_buffer(self._buffer[ |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |                    buffer = [                                           | |
| |                                 Segment('\U0001f539 ', Style()),                | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP           ',        | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'cyan',                     | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=6                    | |
| |                                         ),                              | |
| |                                         bold=True                       | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'event',                            | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'SYSTEM_STARTUP',                   | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment(' ', Style()),                  | |
| |                                 Segment(                                | |
| |                                     'mode',                             | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'yellow',                   | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=3                    | |
| |                                         ),                              | |
| |                                         dim=True,                       | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 Segment('=', Style(dim=True)),          | |
| |                                 Segment(                                | |
| |                                     'backtest',                         | |
| |                                     Style(                              | |
| |                                         color=Color(                    | |
| |                                             'magenta',                  | |
| |                                             ColorType.STANDARD,         | |
| |                                             number=5                    | |
| |                                         ),                              | |
| |                                         italic=False                    | |
| |                                     )                                   | |
| |                                 ),                                      | |
| |                                 ... +60                                 | |
| |                             ]                                           | |
| |                    fileno = 1                                           | |
| |                      self = <console width=79 None>                     | |
| | use_legacy_windows_render = True                                        | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_windows |
| _renderer.py:19 in legacy_windows_render                                    |
|                                                                             |
|   16             if style:                                                  |
|   17                 term.write_styled(text, style)                         |
|   18             else:                                                      |
| > 19                 term.write_text(text)                                  |
|   20         else:                                                          |
|   21             control_codes: Sequence[ControlCode] = control             |
|   22             for control_code in control_codes:                         |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| |  buffer = [                                                             | |
| |               Segment('\U0001f539 ', Style()),                                  | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP           ',                          | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'cyan',                                       | |
| |                           ColorType.STANDARD,                           | |
| |                           number=6                                      | |
| |                       ),                                                | |
| |                       bold=True                                         | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'event',                                              | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'SYSTEM_STARTUP',                                     | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment(' ', Style()),                                    | |
| |               Segment(                                                  | |
| |                   'mode',                                               | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'yellow',                                     | |
| |                           ColorType.STANDARD,                           | |
| |                           number=3                                      | |
| |                       ),                                                | |
| |                       dim=True,                                         | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               Segment('=', Style(dim=True)),                            | |
| |               Segment(                                                  | |
| |                   'backtest',                                           | |
| |                   Style(                                                | |
| |                       color=Color(                                      | |
| |                           'magenta',                                    | |
| |                           ColorType.STANDARD,                           | |
| |                           number=5                                      | |
| |                       ),                                                | |
| |                       italic=False                                      | |
| |                   )                                                     | |
| |               ),                                                        | |
| |               ... +60                                                   | |
| |           ]                                                             | |
| | control = None                                                          | |
| |   style = Style()                                                       | |
| |    term = <rich._win32_console.LegacyWindowsTerm object at              | |
| |           0x000001C2C7BF89B0>                                           | |
| |    text = '\U0001f539 '                                                         | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\rich\_win32_c |
| onsole.py:402 in write_text                                                 |
|                                                                             |
|   399         Args:                                                         |
|   400             text (str): The text to write to the console              |
|   401         """                                                           |
| > 402         self.write(text)                                              |
|   403         self.flush()                                                  |
|   404                                                                       |
|   405     def write_styled(self, text: str, style: Style) -> None:          |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | self = <rich._win32_console.LegacyWindowsTerm object at                 | |
| |        0x000001C2C7BF89B0>                                              | |
| | text = '\U0001f539 '                                                            | |
| +-------------------------------------------------------------------------+ |
|                                                                             |
| C:\ProgramData\miniconda3\Lib\encodings\cp1252.py:19 in encode              |
|                                                                             |
|    16                                                                       |
|    17 class IncrementalEncoder(codecs.IncrementalEncoder):                  |
|    18     def encode(self, input, final=False):                             |
| >  19         return codecs.charmap_encode(input,self.errors,encoding_table |
|    20                                                                       |
|    21 class IncrementalDecoder(codecs.IncrementalDecoder):                  |
|    22     def decode(self, input, final=False):                             |
|                                                                             |
| +-------------------------------- locals ---------------------------------+ |
| | final = False                                                           | |
| | input = '\U0001f539 '                                                           | |
| |  self = <encodings.cp1252.IncrementalEncoder object at                  | |
| |         0x000001C2C295BEC0>                                             | |
| +-------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------+
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f539' in 
position 0: character maps to <undefined>

============================== warnings summary ===============================
..\..\AppData\Roaming\Python\Python312\site-packages\_pytest\cacheprovider.py:475
  C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\_pytest\cacheprovider.py:475: PytestCacheWarning: could not create cache path C:\Users\lovel\trading\btc-laptop-agents\.pytest_cache\v\cache\nodeids: [WinError 5] Access is denied: 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\.pytest_cache\\v\\cache'
    config.cache.set("cache/nodeids", sorted(self.cached_nodeids))

..\..\AppData\Roaming\Python\Python312\site-packages\_pytest\cacheprovider.py:429
  C:\Users\lovel\AppData\Roaming\Python\Python312\site-packages\_pytest\cacheprovider.py:429: PytestCacheWarning: could not create cache path C:\Users\lovel\trading\btc-laptop-agents\.pytest_cache\v\cache\lastfailed: [WinError 5] Access is denied: 'C:\\Users\\lovel\\trading\\btc-laptop-agents\\.pytest_cache\\v\\cache'
    config.cache.set("cache/lastfailed", self.lastfailed)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_run_reproducibility.py::test_selftest - AssertionError: Sel...
FAILED tests/test_run_reproducibility.py::test_backtest_reproducibility - Ass...
======================== 2 failed, 2 warnings in 4.28s ========================
